{{ $path := .Get "src" }}
{{ $alt := .Get "alt" }}
{{ $caption := .Get "title" }}
{{ $class := .Get "class" }}
{{ $style := .Get "style" }}

{{/* 确定最终的图片路径 */}}
{{ $finalPath := $path | absURL }}
{{ if $.Site.Params.enableCDN }}
{{ if hasPrefix $path "/" }}
{{ $finalPath = printf "https://cdn.jsdelivr.net/gh/whiteppure/iblog@main/docs%s" $path }}
{{ else }}
{{ $finalPath = printf "https://cdn.jsdelivr.net/gh/whiteppure/iblog@main/docs/%s" $path }}
{{ end }}
{{ end }}

{{/* 如果没有提供 alt 文本，尝试使用 caption */}}
{{ if not $alt }}
{{ $alt = $caption }}
{{ end }}


<style>
    .img-item {
        border-radius: 12px;
        overflow: hidden;
        flex: 1 1 200px;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        background-color: #fff;
        grid-row-end: span 18;
        margin: 0 3px 3px 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        max-width: 200px;
        max-height: 200px;
    }
    .img-item img {
        width: 100%;
        height: auto;
        border-radius: 8px;
        object-fit: cover;
    }

</style>

<div class="img-item">
        <img src="{{ $finalPath }}"
             alt="{{ $alt }}"
             {{ with $class }}class="{{ . }}"{{ end }}
             {{ with $style }}style="{{ . }}"{{ end }} />
</div>