{{ $path := .Get "src" }}
{{ $alt := .Get "alt" }}
{{ $caption := .Get "title" }}
{{ $class := .Get "class" }}
{{ $style := .Get "style" }}

{{/* 确定最终的图片路径 */}}
{{ $finalPath := $path | absURL }}
{{ if $.Site.Params.enableCDN }}
{{ if hasPrefix $path "/" }}
{{ $finalPath = printf "https://cdn.jsdelivr.net/gh/whiteppure/iblog@main/docs%s" $path }}
{{ else }}
{{ $finalPath = printf "https://cdn.jsdelivr.net/gh/whiteppure/iblog@main/docs/%s" $path }}
{{ end }}
{{ end }}

{{/* 如果没有提供 alt 文本，尝试使用 caption */}}
{{ if not $alt }}
{{ $alt = $caption }}
{{ end }}

<style>
        .img-item {
                border-radius: 12px;
                overflow: hidden;
                flex: 1 1 calc(25% - 12px); /* 默认4列 */
                min-width: 180px;
                max-width: 240px;
                box-shadow: 0 6px 16px rgba(0,0,0,0.12);
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                margin: 0;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                cursor: pointer;
                position: relative;
        }

        .img-item:hover {
                transform: translateY(-4px);
                box-shadow: 0 12px 28px rgba(0,0,0,0.15);
        }

        .img-item img {
                width: 100%;
                height: 180px;
                border-radius: 8px;
                object-fit: cover;
                transition: transform 0.3s ease;
        }

        .img-item:hover img {
                transform: scale(1.03);
        }


        /* 大桌面端 - 5列 */
        @media screen and (min-width: 1440px) {
                .img-item {
                        flex: 1 1 calc(20% - 16px);
                        min-width: 200px;
                        max-width: 260px;
                }

                .img-item img {
                        height: 200px;
                }
        }

        /* 中等桌面端 - 4列 (默认) */
        @media screen and (min-width: 1024px) and (max-width: 1439px) {
                .img-item {
                        flex: 1 1 calc(25% - 16px);
                        min-width: 180px;
                        max-width: 240px;
                }

                .img-item img {
                        height: 180px;
                }
        }

        /* 平板端 - 3列 */
        @media screen and (min-width: 768px) and (max-width: 1023px) {
                .img-item {
                        flex: 1 1 calc(33.333% - 14px);
                        min-width: 160px;
                        max-width: 220px;
                }

                .img-item img {
                        height: 160px;
                }
        }

        /* 大移动端 - 2列 */
        @media screen and (min-width: 480px) and (max-width: 767px) {
                .img-item {
                        flex: 1 1 calc(50% - 12px);
                        min-width: 140px;
                        max-width: none;
                }

                .img-item img {
                        height: 150px;
                }
        }

        /* 小移动端 - 单列显示，图片更大 */
        @media screen and (max-width: 479px) {
                .img-item {
                        flex: 1 1 100%;
                        min-width: 100%;
                        max-width: 100%;
                        margin: 0 0 12px 0;
                }

                .img-item img {
                        height: 200px;
                        border-radius: 10px;
                }
        }
</style>

<div class="img-item">
        <img src="{{ $finalPath }}"
             alt="{{ $alt }}"
             {{ with $class }}class="{{ . }}"{{ end }}
             {{ with $style }}style="{{ . }}"{{ end }} />
</div>