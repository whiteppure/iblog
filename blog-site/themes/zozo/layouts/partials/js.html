<!-- cdn加速配置 -->
{{ $base := .Site.BaseURL }}
{{ if .Site.Params.enableCDN }}
{{ $base = printf "https://cdn.jsdelivr.net/gh/whiteppure/iblog@main/docs/" }}
{{ end }}

<!-- JS 资源 -->
<script src="{{ $base }}js/jquery-3.5.1.min.js"></script>
<script src="{{ $base }}js/fancybox.min.js"></script>
<script src="{{ $base }}js/darkmode.js"></script>
<script src="{{ $base }}js/zozo.js"></script>
<!--<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>-->
<!--<script src="{{ $base }}js/busuanzi_2.3_busuanzi.pure.mini.js"></script>-->
<script src="//cdn.busuanzi.cc/busuanzi/3.6.9/busuanzi.min.js" defer></script>
<script src="{{ $base }}js/html2canvas.js"></script>
<script src="{{ $base }}js/utils.js"></script>
<script src="{{ $base }}js/html2md.js"></script>
<script src="{{ $base }}js/htmlexport.js"></script>
<script src="{{ $base }}js/fastsearch.js"></script>
<script src="{{ $base }}js/fuse.js"></script>

<!-- dark mode -->
<script>
    <!-- 手动控制夜间模式  -->
    // new Darkmode({
    //     right: '32px', // default: '32px'
    //     bottom: 'unset', // default: '32px'
    //     // left: '32px', // default: 'unset'
    //     time: '0.15s', // default: '0.3s'
    //     mixColor: '#f7f7f7', // default: '#fff'
    //     backgroundColor: '#f7f7f7', // default: '#fff'
    //     buttonColorDark: '#212121', // default: '#100f2c'
    //     buttonColorLight: '#f7f7f7', // default: '#fff'
    //     saveInCookies: false, // default: true,
    //     autoMatchOsTheme: true // default: true
    // }).showWidget();

    // function addDarkmodeWidget(){
    //     const hours = new Date().getHours();
    //     // if (hours >= 19 || hours <= 5){
    //         new Darkmode({
    //             right: '32px', // default: '32px'
    //             bottom: 'unset', // default: '32px'
    //             // left: '32px', // default: 'unset'
    //             time: '0.1s', // default: '0.3s'
    //             mixColor: '#f7f7f7', // default: '#fff'
    //             backgroundColor: '#fff', // default: '#fff'
    //             buttonColorDark: '#100f2c', // default: '#100f2c'
    //             buttonColorLight: '#f7f7f7', // default: '#fff'
    //             saveInCookies: false, // default: true,
    //             autoMatchOsTheme: true // default: true
    //         }).toggle();
    //     // }
    // }
    // 自动调用夜间模式
    // addDarkmodeWidget();
</script>


<script>
    // 卜算子计数处理
    document.addEventListener("DOMContentLoaded", function () {
        const uvE = document.getElementById('busuanzi_site_pv');
        const pvE = document.getElementById('busuanzi_site_uv');
        const uvObs = new MutationObserver((mutationsList) => {
            for (let mutation of mutationsList) {
                if (mutation.type === 'childList') {
                    uvObs.disconnect();
                    mutation.target.innerHTML = parseInt(mutation.target.innerHTML) + 57030;
                    break;
                }
            }
        });
        const pvObs = new MutationObserver((mutationsList) => {
            for (let mutation of mutationsList) {
                if (mutation.type === 'childList') {
                    pvObs.disconnect();
                    mutation.target.innerHTML = parseInt(mutation.target.innerHTML) + 203040;
                    break;
                }
            }
        });
        const config = {
            childList: true
        };
        uvObs.observe(uvE, config);
        pvObs.observe(pvE, config);
    });
</script>

<script>
    // 处理网站超链接
    document.addEventListener('DOMContentLoaded', function() {
        // 获取当前网站域名
        const currentHost = window.location.hostname;

        // 选择所有需要处理的链接
        const links = document.querySelectorAll('.content a');

        links.forEach(function(link) {
            // 跳过空链接或无效链接
            if (!link.href) return;
            try {
                // 获取链接的域名
                const linkHost = new URL(link.href, window.location.href).hostname;

                // 比较域名，设置不同的打开方式
                if (linkHost === currentHost) {
                    // 站内链接 - 移除target="_blank"
                    link.removeAttribute('target');
                    link.classList.add('internal-link');
                } else {
                    // 站外链接 - 添加target="_blank"
                    link.setAttribute('target', '_blank');
                    link.classList.add('external-link');
                }
            } catch (e) {
                // 如果URL解析失败，保守处理，不设置target="_blank"
                console.warn('无法解析链接:', link.href);
            }
        });
    });
</script>

<!-- 数学公式 -->
{{ if .Site.Params.enableMathJax }}
{{ partial "mathjax.html" . }}
{{ end }}


{{ template "_internal/google_analytics.html" . }}



