<!DOCTYPE html>
<html lang="zh" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="whitepure" />
	
	
	
	<title>Java小程序 ｜ 唯手熟尔</title>
	
    
    
    <meta name="description" content="写在前面 本文中所涉及的程序均为Java开发，如果您想要直接使用这些工具需要提前配置Java环境。所涉及到的程序均提供完整代码，如果您有兴趣可以尝试运行。 使用ja" />
    

    
    
    <meta name="keywords" content="whitepure博客, whiteppure, whitepure" />
    

	
    
    <link rel="shortcut icon" href="https://whiteppure.github.io/iblog/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://whiteppure.github.io/iblog/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://whiteppure.github.io/iblog/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://whiteppure.github.io/iblog/css/highlight.css" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://whiteppure.github.io/iblog/css/toc.css" />

    
    
</head>

<body>
    
    
    









<div class="toc">

    <div class="page-header"><strong></strong></div>

    <div id="page-scrollspy" class="toc-nav">

        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e5%86%99%e5%9c%a8%e5%89%8d%e9%9d%a2">
                    写在前面
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e5%bc%ba%e5%af%86%e7%a0%81%e7%94%9f%e6%88%90%e5%99%a8">
                    强密码生成器
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e4%bb%a3%e7%a0%81">
                    代码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e6%88%aa%e5%9b%be%e5%b7%a5%e5%85%b7">
                    截图工具
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e4%bb%a3%e7%a0%81-1">
                    代码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e6%96%87%e5%ad%97%e8%bd%ac%e4%ba%8c%e7%bb%b4%e7%a0%81">
                    文字转二维码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e4%bb%a3%e7%a0%81-2">
                    代码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e8%8b%b1%e6%96%87%e7%bf%bb%e8%af%91%e5%99%a8">
                    英文翻译器
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e4%bb%a3%e7%a0%81-3">
                    代码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e6%8f%90%e8%89%b2%e5%99%a8">
                    提色器
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e4%bb%a3%e7%a0%81-4">
                    代码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e5%9b%be%e7%89%87%e6%b0%b4%e5%8d%b0%e7%94%9f%e6%88%90%e5%99%a8">
                    图片水印生成器
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e4%bb%a3%e7%a0%81-5">
                    代码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#huffman%e5%8e%8b%e7%bc%a9">
                    huffman压缩
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        
        
        
        
        
        
        
        
        <ul class="nav">
            
        <ul class="nav">
            
        <ul class="nav">
            
            
            <li class="nav-item">
                <a class="nav-link text-left" href="#%e4%bb%a3%e7%a0%81-6">
                    代码
                </a>
            </li>
            
            
        </ul>
        
        </ul>
        
        </ul>
        
        
        
        

    </div>

</div>



    
    <div class="main animate__animated animate__fadeInDown" id="pdf_content">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul><li class="">
                <a href="https://whiteppure.github.io/iblog/">首页</a>
            </li><li class="">
                <a href="https://whiteppure.github.io/iblog/posts/">归档</a>
            </li><li class="">
                <a href="https://whiteppure.github.io/iblog/tags/">标签</a>
            </li><li class="">
                <a href="https://whiteppure.github.io/iblog/about/">关于</a>
            </li>
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="https://whiteppure.github.io/iblog/">
                    <span>唯手熟尔</span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title">
                无他,唯手熟尔
            </p>
            <div class="my_socials">
                
                
                <a href="https://github.com/whiteppure/" title="github" target="_blank">
                    <i class="ri-github-fill"></i>
                </a>
                
                
                <a href="https://whiteppure.github.io/iblog/index.xml" type="application/rss+xml" title="rss" target="_blank">
                    <i class="ri-rss-fill"></i>
                </a>
                



            </div>
            
            <div class="post">
                <div class="post_title post_detail_title">
                    <span class="date" id="busuanzi_container_site_pv">访问量 <span id="busuanzi_value_site_pv"></span>次</span>
                </div>
                <div class="post_title post_detail_title">
                    <span class="date" id="busuanzi_container_site_uv">访客数 <span id="busuanzi_value_site_uv"></span>人</span>
                </div>
            </div>
            
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='/iblog/posts/readme/java-gadget/'>Java小程序</a></h2>
                        <span class="date">2022.04.09</span>
                    </div>
                    <div class="post_content markdown"><h2 id="写在前面">写在前面</h2>
<p>本文中所涉及的程序均为Java开发，如果您想要直接使用这些工具需要提前配置Java环境。所涉及到的程序均提供完整代码，如果您有兴趣可以尝试运行。</p>
<p>使用<code>java -jar</code>命令启动</p>
<p><img src="/iblog/posts/annex/images/readme/readme-009.png" alt="readme-009"></p>
<p>某些程序功能并不是很完善，但是也可以凑合着用，写这些程序的主要目的是为了方便理解一些常用软件的实现逻辑。</p>
<h2 id="强密码生成器">强密码生成器</h2>
<p>生成6到20位的随机强密码，可指定密码长度、密码内容。<a href="/iblog/posts/annex/jar/auto-pwd.jar">点击下载</a></p>
<p><img src="/iblog/posts/annex/images/readme/readme-001.png" alt="readme-001"></p>
<h3 id="代码">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 随机生成字符抽象类
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractRandomChar</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">LOW_STR</span> <span class="o">=</span> <span class="s">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">UPPER_STR</span> <span class="o">=</span> <span class="s">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SPECIAL_STR</span> <span class="o">=</span> <span class="s">&#34;~!@#$%^&amp;*()_+/|-=[]{};:&#39;&lt;&gt;?.&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NUM_STR</span> <span class="o">=</span> <span class="s">&#34;0123456789&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 根据字符串获取随机获取字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param str 指定字符串
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 返回一个随机字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">char</span> <span class="nf">getRandomChar</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SecureRandom</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 获取随机字符，根据不同的子类不同的实现。现有类型，随机数字、随机大些字母、随机小写字母、随机特殊字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 随机字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kd">abstract</span> <span class="kt">char</span> <span class="nf">getRandomChar</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RandomLowChar</span> <span class="kd">extends</span> <span class="n">AbstractRandomChar</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 随机获取小写字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 随机小写字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">char</span> <span class="nf">getRandomChar</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">getRandomChar</span><span class="o">(</span><span class="n">LOW_STR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RandomNumChar</span> <span class="kd">extends</span> <span class="n">AbstractRandomChar</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 获取随机获取数字字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 随机获取数字字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">char</span> <span class="nf">getRandomChar</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">getRandomChar</span><span class="o">(</span><span class="n">NUM_STR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RandomSpecialChar</span> <span class="kd">extends</span> <span class="n">AbstractRandomChar</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 获取随机获取特殊字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 随机大写字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">char</span> <span class="nf">getRandomChar</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">getRandomChar</span><span class="o">(</span><span class="n">SPECIAL_STR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RandomUpperChar</span> <span class="kd">extends</span> <span class="n">AbstractRandomChar</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 随机获取大写字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 随机大写字符
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">char</span> <span class="nf">getRandomChar</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">getRandomChar</span><span class="o">(</span><span class="n">UPPER_STR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 生成随机密码
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenRandomPwd</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 保存 AbstractRandomChar 对象,用于随机数生成
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">AbstractRandomChar</span><span class="o">&gt;</span> <span class="n">randomCharList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">GenRandomPwd</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">genNumCharPwd</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">genLowCharPwd</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">genUpperCharPwd</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">genSpecialCharPwd</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">genNumCharPwd</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">randomCharList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">RandomNumChar</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">genLowCharPwd</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">randomCharList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">RandomLowChar</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">genUpperCharPwd</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">randomCharList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">RandomUpperChar</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">genSpecialCharPwd</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">randomCharList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">RandomSpecialChar</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 默认都是false的情况下 指定只用数字生成随机数字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">randomCharList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">randomCharList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">RandomNumChar</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getRandomPwd</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 密码最大长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">maxPwdLength</span> <span class="o">=</span> <span class="n">25</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 密码最小长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">minPwdLength</span> <span class="o">=</span> <span class="n">6</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">length</span> <span class="o">&gt;</span> <span class="n">maxPwdLength</span> <span class="o">||</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">minPwdLength</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;密码长度在%d～%d位之间&#34;</span><span class="o">,</span> <span class="n">minPwdLength</span><span class="o">,</span> <span class="n">maxPwdLength</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建集合将随机生成的字符放入到集合中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">length</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 产生随机数用于随机调用生成字符的函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">randomListSize</span> <span class="o">=</span> <span class="n">randomCharList</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">randomCharNum</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">randomListSize</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 随机从randomCharList中获取一个字符，并加入到list中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">randomCharList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">randomCharNum</span><span class="o">).</span><span class="na">getRandomChar</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 将选好的list打乱顺序重新排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 将char类型转string字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">StringBuilder</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="n">Character</span> <span class="n">c</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PwdFrame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Frame</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Frame</span><span class="o">(</span><span class="s">&#34;强密码生成器&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">pwdNumContent</span> <span class="o">=</span> <span class="s">&#34;123&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">pwdLowContent</span> <span class="o">=</span> <span class="s">&#34;abc&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">pwdUpperContent</span> <span class="o">=</span> <span class="s">&#34;ABC&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">pwdSpecialContent</span> <span class="o">=</span> <span class="s">&#34;!@#&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 一些组件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">TextField</span> <span class="n">tf</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextField</span><span class="o">(</span><span class="n">22</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="na">setBounds</span><span class="o">(</span><span class="n">600</span><span class="o">,</span> <span class="n">250</span><span class="o">,</span> <span class="n">280</span><span class="o">,</span> <span class="n">140</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">genPwdBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;生成&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JLabel</span> <span class="n">lenLabel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="s">&#34;长度&#34;</span><span class="o">,</span> <span class="n">JLabel</span><span class="o">.</span><span class="na">LEFT</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JLabel</span> <span class="n">contentLabel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="s">&#34;内容&#34;</span><span class="o">,</span> <span class="n">JLabel</span><span class="o">.</span><span class="na">LEFT</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">panel1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">panel2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 密码长度单选框
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">ButtonGroup</span> <span class="n">lenGroup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ButtonGroup</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">len1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="s">&#34;6&#34;</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">len2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="s">&#34;8&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">len3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="s">&#34;14&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">len4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="s">&#34;16&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">len5</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="s">&#34;20&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">lenGroup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">lenGroup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">lenGroup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">lenGroup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len4</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">lenGroup</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 密码内容复选框
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">JRadioButton</span> <span class="n">content1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="n">pwdNumContent</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">content2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="n">pwdLowContent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">content3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="n">pwdUpperContent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JRadioButton</span> <span class="n">content4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JRadioButton</span><span class="o">(</span><span class="n">pwdSpecialContent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 将组件添加到 panel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">panel1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">lenLabel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len4</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">len5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">panel2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">contentLabel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">content1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">content2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">content3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">content4</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置按钮功能
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">genPwdBtn</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 获取密码长度单选框的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">String</span> <span class="n">checkBoxValLength</span> <span class="o">=</span> <span class="n">getCheckBoxVal</span><span class="o">(</span><span class="n">panel1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 获取密码内容单选框的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">String</span> <span class="n">checkBoxValContent</span> <span class="o">=</span> <span class="n">getCheckBoxVal</span><span class="o">(</span><span class="n">panel2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">boolean</span> <span class="n">numPwd</span> <span class="o">=</span> <span class="n">checkBoxValContent</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">pwdNumContent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">boolean</span> <span class="n">lowPwd</span> <span class="o">=</span> <span class="n">checkBoxValContent</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">pwdLowContent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">boolean</span> <span class="n">upperPwd</span> <span class="o">=</span> <span class="n">checkBoxValContent</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">pwdUpperContent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">boolean</span> <span class="n">specialPwd</span> <span class="o">=</span> <span class="n">checkBoxValContent</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">pwdSpecialContent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 生成强密码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">GenRandomPwd</span> <span class="n">genRandomPwd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GenRandomPwd</span><span class="o">(</span><span class="n">numPwd</span><span class="o">,</span> <span class="n">lowPwd</span><span class="o">,</span> <span class="n">upperPwd</span><span class="o">,</span> <span class="n">specialPwd</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">tf</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">genRandomPwd</span><span class="o">.</span><span class="na">getRandomPwd</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">checkBoxValLength</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 获取光标，使光标一直在文本框内
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">tf</span><span class="o">.</span><span class="na">requestFocus</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">tf</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">genPwdBtn</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">panel1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">panel2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="na">setResizable</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//设置窗体布局模式为流式布局
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">f</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//关闭窗口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">f</span><span class="o">.</span><span class="na">addWindowListener</span><span class="o">(</span><span class="k">new</span> <span class="n">WindowAdapter</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">windowClosing</span><span class="o">(</span><span class="n">WindowEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 获取单选框、复选框的值
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param panel panel对象
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 单选框的值
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getCheckBoxVal</span><span class="o">(</span><span class="n">JPanel</span> <span class="n">panel</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">StringBuilder</span> <span class="n">info</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="n">Component</span> <span class="n">c</span> <span class="o">:</span> <span class="n">panel</span><span class="o">.</span><span class="na">getComponents</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="k">instanceof</span> <span class="n">JRadioButton</span> <span class="o">&amp;&amp;</span> <span class="o">((</span><span class="n">JRadioButton</span><span class="o">)</span> <span class="n">c</span><span class="o">).</span><span class="na">isSelected</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 按空格拆分获取复选框的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">info</span><span class="o">.</span><span class="na">append</span><span class="o">(((</span><span class="n">JRadioButton</span><span class="o">)</span> <span class="n">c</span><span class="o">).</span><span class="na">getText</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">info</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AutoPwdMainStarter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">PwdFrame</span><span class="o">().</span><span class="na">init</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="截图工具">截图工具</h2>
<p>截图小工具，支持复制到粘贴板、一次性截取多张图片。<a href="/iblog/posts/annex/jar/cut-screen.jar">点击下载</a></p>
<p><img src="/iblog/posts/annex/images/readme/readme-002.png" alt="readme-002"></p>
<p><img src="/iblog/posts/annex/images/readme/readme-003.png" alt="readme-003"></p>
<h3 id="代码-1">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 截屏小工具 参考：https://blog.csdn.net/Code__rookie/article/details/103509851 有改动
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @author whitepure
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CaptureScreen</span> <span class="kd">extends</span> <span class="n">JFrame</span> <span class="kd">implements</span> <span class="n">ActionListener</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">JButton</span> <span class="n">start</span><span class="o">,</span> <span class="n">cancel</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">JPanel</span> <span class="n">c</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">BufferedImage</span> <span class="n">get</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">JTabbedPane</span> <span class="n">jtp</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">CaptureScreen</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">super</span><span class="o">(</span><span class="s">&#34;屏幕截取&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">UIManager</span><span class="o">.</span><span class="na">setLookAndFeel</span><span class="o">(</span><span class="n">UIManager</span><span class="o">.</span><span class="na">getSystemLookAndFeelClassName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">exe</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;截图异常&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">exe</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">initWindow</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">jtp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTabbedPane</span><span class="o">(</span><span class="n">JTabbedPane</span><span class="o">.</span><span class="na">TOP</span><span class="o">,</span> <span class="n">JTabbedPane</span><span class="o">.</span><span class="na">SCROLL_TAB_LAYOUT</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 初始化窗口
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initWindow</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;开始截取&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">cancel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;退出&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">cancel</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">panel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">all</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">(</span><span class="k">new</span> <span class="n">BorderLayout</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">start</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">cancel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">all</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">panel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">all</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">setFrameSizeDefault</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setAlwaysOnTop</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setResizable</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 设置窗口size 位置
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setFrameSizeWhenExitsImg</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setSize</span><span class="o">(</span><span class="n">720</span><span class="o">,</span> <span class="n">620</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setLocation</span><span class="o">(</span><span class="n">400</span><span class="o">,</span><span class="n">150</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 设置窗口size 位置
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setFrameSizeDefault</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setSize</span><span class="o">(</span><span class="n">180</span><span class="o">,</span> <span class="n">80</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setLocation</span><span class="o">(</span><span class="n">600</span><span class="o">,</span><span class="n">300</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">updates</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">get</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果索引是0,则表示一张图片都没有被加入过,则要清除当前的东西,重新把tabpane放进来
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">c</span><span class="o">.</span><span class="na">removeAll</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">jtp</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">PicPanel</span> <span class="n">pic</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PicPanel</span><span class="o">(</span><span class="n">get</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">jtp</span><span class="o">.</span><span class="na">addTab</span><span class="o">(</span><span class="s">&#34;图片&#34;</span> <span class="o">+</span> <span class="o">(++</span><span class="n">index</span><span class="o">),</span> <span class="n">pic</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">jtp</span><span class="o">.</span><span class="na">setSelectedComponent</span><span class="o">(</span><span class="n">pic</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">SwingUtilities</span><span class="o">.</span><span class="na">updateComponentTreeUI</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 点击开始截屏执行
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">doStart</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 点击截屏后隐藏主界面并 sleep 500ms 彻底隐藏主界面
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">this</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">500</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Dimension</span> <span class="n">dimension</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">getDefaultToolkit</span><span class="o">().</span><span class="na">getScreenSize</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">Rectangle</span> <span class="n">rec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">dimension</span><span class="o">.</span><span class="na">width</span><span class="o">,</span> <span class="n">dimension</span><span class="o">.</span><span class="na">height</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">BufferedImage</span> <span class="n">bi</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">bi</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Robot</span><span class="o">().</span><span class="na">createScreenCapture</span><span class="o">(</span><span class="n">rec</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">AWTException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">JFrame</span> <span class="n">jf</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFrame</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 自定义的截屏时窗口对象，调整大小然后开始截图
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">CutScreen</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CutScreen</span><span class="o">(</span><span class="n">jf</span><span class="o">,</span> <span class="n">bi</span><span class="o">,</span> <span class="n">dimension</span><span class="o">.</span><span class="na">width</span><span class="o">,</span> <span class="n">dimension</span><span class="o">.</span><span class="na">height</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">jf</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">temp</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">jf</span><span class="o">.</span><span class="na">setUndecorated</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">jf</span><span class="o">.</span><span class="na">setSize</span><span class="o">(</span><span class="n">dimension</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">jf</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">jf</span><span class="o">.</span><span class="na">setAlwaysOnTop</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置当前窗口大小
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">setFrameSizeWhenExitsImg</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 公用的处理保存图片的方法
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSave</span><span class="o">(</span><span class="n">BufferedImage</span> <span class="n">get</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">get</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="k">this</span>
</span></span><span class="line"><span class="cl">                        <span class="o">,</span> <span class="s">&#34;图片不能为空!!&#34;</span><span class="o">,</span> <span class="s">&#34;错误&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">ERROR_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">JFileChooser</span> <span class="n">jfc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFileChooser</span><span class="o">(</span><span class="s">&#34;.&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">jfc</span><span class="o">.</span><span class="na">addChoosableFileFilter</span><span class="o">(</span><span class="k">new</span> <span class="n">gifFilter</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">jfc</span><span class="o">.</span><span class="na">addChoosableFileFilter</span><span class="o">(</span><span class="k">new</span> <span class="n">bmpFilter</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">jfc</span><span class="o">.</span><span class="na">addChoosableFileFilter</span><span class="o">(</span><span class="k">new</span> <span class="n">jpgFilter</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">jfc</span><span class="o">.</span><span class="na">addChoosableFileFilter</span><span class="o">(</span><span class="k">new</span> <span class="n">pngFilter</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">jfc</span><span class="o">.</span><span class="na">showSaveDialog</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">JFileChooser</span><span class="o">.</span><span class="na">APPROVE_OPTION</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">jfc</span><span class="o">.</span><span class="na">getSelectedFile</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">String</span> <span class="n">about</span> <span class="o">=</span> <span class="s">&#34;PNG&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">String</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">filechooser</span><span class="o">.</span><span class="na">FileFilter</span> <span class="n">ff</span> <span class="o">=</span> <span class="n">jfc</span><span class="o">.</span><span class="na">getFileFilter</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">ff</span> <span class="k">instanceof</span> <span class="n">jpgFilter</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(!</span><span class="n">ext</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.jpg&#34;</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">String</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">ext</span> <span class="o">+</span> <span class="s">&#34;.jpg&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">ns</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">about</span> <span class="o">=</span> <span class="s">&#34;JPG&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">ff</span> <span class="k">instanceof</span> <span class="n">pngFilter</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(!</span><span class="n">ext</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.png&#34;</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">String</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">ext</span> <span class="o">+</span> <span class="s">&#34;.png&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">ns</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">about</span> <span class="o">=</span> <span class="s">&#34;PNG&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">ff</span> <span class="k">instanceof</span> <span class="n">bmpFilter</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(!</span><span class="n">ext</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.bmp&#34;</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">String</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">ext</span> <span class="o">+</span> <span class="s">&#34;.bmp&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">ns</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">about</span> <span class="o">=</span> <span class="s">&#34;BMP&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">ff</span> <span class="k">instanceof</span> <span class="n">gifFilter</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(!</span><span class="n">ext</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.gif&#34;</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">String</span> <span class="n">ns</span> <span class="o">=</span> <span class="n">ext</span> <span class="o">+</span> <span class="s">&#34;.gif&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                        <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">ns</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">about</span> <span class="o">=</span> <span class="s">&#34;GIF&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">ImageIO</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">get</span><span class="o">,</span> <span class="n">about</span><span class="o">,</span> <span class="n">file</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">&#34;保存成功！&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">&#34;保存失败！&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">exe</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">exe</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 公共的处理把当前的图片加入剪帖板的方法
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doCopy</span><span class="o">(</span><span class="kd">final</span> <span class="n">BufferedImage</span> <span class="n">image</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">get</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="k">this</span>
</span></span><span class="line"><span class="cl">                        <span class="o">,</span> <span class="s">&#34;图片不能为空!!&#34;</span><span class="o">,</span> <span class="s">&#34;错误&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">ERROR_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">Transferable</span> <span class="n">trans</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Transferable</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">                <span class="kd">public</span> <span class="n">DataFlavor</span><span class="o">[]</span> <span class="nf">getTransferDataFlavors</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="k">new</span> <span class="n">DataFlavor</span><span class="o">[]{</span><span class="n">DataFlavor</span><span class="o">.</span><span class="na">imageFlavor</span><span class="o">};</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">                <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isDataFlavorSupported</span><span class="o">(</span><span class="n">DataFlavor</span> <span class="n">flavor</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="n">DataFlavor</span><span class="o">.</span><span class="na">imageFlavor</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">flavor</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">                <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getTransferData</span><span class="o">(</span><span class="n">DataFlavor</span> <span class="n">flavor</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                        <span class="kd">throws</span> <span class="n">UnsupportedFlavorException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(</span><span class="n">isDataFlavorSupported</span><span class="o">(</span><span class="n">flavor</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="n">image</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                    <span class="k">throw</span> <span class="k">new</span> <span class="n">UnsupportedFlavorException</span><span class="o">(</span><span class="n">flavor</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">Toolkit</span><span class="o">.</span><span class="na">getDefaultToolkit</span><span class="o">().</span><span class="na">getSystemClipboard</span><span class="o">().</span><span class="na">setContents</span><span class="o">(</span><span class="n">trans</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">&#34;已复制到系统粘帖板!!&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">exe</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">exe</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="k">this</span>
</span></span><span class="line"><span class="cl">                    <span class="o">,</span> <span class="s">&#34;复制到系统粘帖板出错!!&#34;</span><span class="o">,</span> <span class="s">&#34;错误&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">ERROR_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 处理关闭事件
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param c 窗口对象
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">doClose</span><span class="o">(</span><span class="n">Component</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">jtp</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">jtp</span><span class="o">.</span><span class="na">getTabCount</span><span class="o">()</span> <span class="o">==</span> <span class="n">0</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 将当前截屏的窗口重置为初始化状态
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">setFrameSizeDefault</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">gc</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 判断当前按钮发生的事件
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ae 事件对象
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">ae</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Object</span> <span class="n">source</span> <span class="o">=</span> <span class="n">ae</span><span class="o">.</span><span class="na">getSource</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">source</span> <span class="o">==</span> <span class="n">start</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">doStart</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">source</span> <span class="o">==</span> <span class="n">cancel</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">UIManager</span><span class="o">.</span><span class="na">setLookAndFeel</span><span class="o">(</span><span class="n">UIManager</span><span class="o">.</span><span class="na">getCrossPlatformLookAndFeelClassName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">SwingUtilities</span><span class="o">.</span><span class="na">updateComponentTreeUI</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">exe</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">exe</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 截图后预览截图的panel
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">PicPanel</span> <span class="kd">extends</span> <span class="n">JPanel</span> <span class="kd">implements</span> <span class="n">ActionListener</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">save</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">copy</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">close</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">BufferedImage</span> <span class="n">get</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="nf">PicPanel</span><span class="o">(</span><span class="n">BufferedImage</span> <span class="n">get</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kd">super</span><span class="o">(</span><span class="k">new</span> <span class="n">BorderLayout</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">get</span> <span class="o">=</span> <span class="n">get</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">initPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 初始化
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initPanel</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">save</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;保存&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;复制到剪帖板&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">close</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;删除&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">JPanel</span> <span class="n">buttonPanel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">buttonPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">copy</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">buttonPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">save</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">buttonPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">close</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">JLabel</span> <span class="n">icon</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="k">new</span> <span class="n">ImageIcon</span><span class="o">(</span><span class="n">get</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">JScrollPane</span><span class="o">(</span><span class="n">icon</span><span class="o">),</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">buttonPanel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">save</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">copy</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">close</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 判断当前按钮点击发生的事件
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param e 事件对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">actionPerformed</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Object</span> <span class="n">source</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getSource</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">source</span> <span class="o">==</span> <span class="n">save</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">doSave</span><span class="o">(</span><span class="n">get</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">source</span> <span class="o">==</span> <span class="n">copy</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">doCopy</span><span class="o">(</span><span class="n">get</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">source</span> <span class="o">==</span> <span class="n">close</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">get</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">doClose</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 保存BMP格式的过滤器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">bmpFilter</span> <span class="kd">extends</span> <span class="n">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">filechooser</span><span class="o">.</span><span class="na">FileFilter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="nf">bmpFilter</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.bmp&#34;</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                    <span class="n">file</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDescription</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">&#34;*.BMP(BMP图像)&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 保存JPG格式的过滤器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">jpgFilter</span> <span class="kd">extends</span> <span class="n">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">filechooser</span><span class="o">.</span><span class="na">FileFilter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="nf">jpgFilter</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.jpg&#34;</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                    <span class="n">file</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDescription</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">&#34;*.JPG(JPG图像)&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 保存GIF格式的过滤器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">gifFilter</span> <span class="kd">extends</span> <span class="n">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">filechooser</span><span class="o">.</span><span class="na">FileFilter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="nf">gifFilter</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.gif&#34;</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                    <span class="n">file</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDescription</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">&#34;*.GIF(GIF图像)&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 保存PNG格式的过滤器
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">pngFilter</span> <span class="kd">extends</span> <span class="n">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">filechooser</span><span class="o">.</span><span class="na">FileFilter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">accept</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">endsWith</span><span class="o">(</span><span class="s">&#34;.png&#34;</span><span class="o">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">                    <span class="n">file</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDescription</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">&#34;*.PNG(PNG图像)&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 显示当前的屏幕图像
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">CutScreen</span> <span class="kd">extends</span> <span class="n">JPanel</span> <span class="kd">implements</span> <span class="n">MouseListener</span><span class="o">,</span> <span class="n">MouseMotionListener</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">START_X</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">START_Y</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">END_X</span> <span class="o">=</span> <span class="n">3</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">END_Y</span> <span class="o">=</span> <span class="n">4</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">final</span> <span class="n">BufferedImage</span> <span class="n">bi</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">width</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kd">final</span> <span class="n">JFrame</span> <span class="n">jf</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//表示一般情况下的鼠标状态（十字线）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">private</span> <span class="kd">final</span> <span class="n">Cursor</span> <span class="n">cs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">CROSSHAIR_CURSOR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">int</span> <span class="n">startX</span><span class="o">,</span> <span class="n">startY</span><span class="o">,</span> <span class="n">endX</span><span class="o">,</span> <span class="n">endY</span><span class="o">,</span> <span class="n">tempX</span><span class="o">,</span> <span class="n">tempY</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//表示选中的区域
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">private</span> <span class="n">Rectangle</span> <span class="n">select</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 表示当前的编辑状态
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">private</span> <span class="n">States</span> <span class="n">current</span> <span class="o">=</span> <span class="n">States</span><span class="o">.</span><span class="na">DEFAULT</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//表示八个编辑点的区域
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">private</span> <span class="n">Rectangle</span><span class="o">[]</span> <span class="n">rec</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//当前被选中的X和Y,只有这两个需要改变
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">private</span> <span class="kt">int</span> <span class="n">currentX</span><span class="o">,</span> <span class="n">currentY</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//当前鼠标移的地点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">private</span> <span class="n">Point</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//是否显示提示.如果鼠标左键一按,则提示就不再显示了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">showTip</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="nf">CutScreen</span><span class="o">(</span><span class="n">JFrame</span> <span class="n">jf</span><span class="o">,</span> <span class="n">BufferedImage</span> <span class="n">bi</span><span class="o">,</span> <span class="kt">int</span> <span class="n">width</span><span class="o">,</span> <span class="kt">int</span> <span class="n">height</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">jf</span> <span class="o">=</span> <span class="n">jf</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">bi</span> <span class="o">=</span> <span class="n">bi</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">width</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">addMouseListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">addMouseMotionListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">initRecs</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initRecs</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">[</span><span class="n">8</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">rec</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">rec</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">paintComponent</span><span class="o">(</span><span class="n">Graphics</span> <span class="n">g</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">drawImage</span><span class="o">(</span><span class="n">bi</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">RED</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">startX</span><span class="o">,</span> <span class="n">startY</span><span class="o">,</span> <span class="n">endX</span><span class="o">,</span> <span class="n">startY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">startX</span><span class="o">,</span> <span class="n">endY</span><span class="o">,</span> <span class="n">endX</span><span class="o">,</span> <span class="n">endY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">startX</span><span class="o">,</span> <span class="n">startY</span><span class="o">,</span> <span class="n">startX</span><span class="o">,</span> <span class="n">endY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">endX</span><span class="o">,</span> <span class="n">startY</span><span class="o">,</span> <span class="n">endX</span><span class="o">,</span> <span class="n">endY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">startX</span><span class="o">,</span> <span class="n">endX</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">startY</span><span class="o">,</span> <span class="n">endY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">select</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">endX</span> <span class="o">-</span> <span class="n">startX</span><span class="o">),</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">endY</span> <span class="o">-</span> <span class="n">startY</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">x1</span> <span class="o">=</span> <span class="o">(</span><span class="n">startX</span> <span class="o">+</span> <span class="n">endX</span><span class="o">)</span> <span class="o">/</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">y1</span> <span class="o">=</span> <span class="o">(</span><span class="n">startY</span> <span class="o">+</span> <span class="n">endY</span><span class="o">)</span> <span class="o">/</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">startY</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">endY</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">startX</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">endX</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">startX</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">startY</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">startX</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">endY</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">endX</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">startY</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">endX</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">endY</span> <span class="o">-</span> <span class="n">2</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">2</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">((</span><span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">startX</span><span class="o">,</span> <span class="n">endX</span><span class="o">))</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">3</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">((</span><span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">startX</span><span class="o">,</span> <span class="n">endX</span><span class="o">))</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">4</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">((</span><span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">startX</span><span class="o">,</span> <span class="n">endX</span><span class="o">))</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">startY</span><span class="o">,</span> <span class="n">endY</span><span class="o">))</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">5</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">startY</span><span class="o">,</span> <span class="n">endY</span><span class="o">))</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">6</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">startY</span><span class="o">,</span> <span class="n">endY</span><span class="o">))</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">rec</span><span class="o">[</span><span class="n">7</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">5</span><span class="o">,</span> <span class="n">10</span><span class="o">,</span> <span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">showTip</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">CYAN</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">y</span><span class="o">,</span> <span class="n">235</span><span class="o">,</span> <span class="n">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">RED</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="na">drawRect</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">y</span><span class="o">,</span> <span class="n">235</span><span class="o">,</span> <span class="n">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span><span class="o">.</span><span class="na">drawString</span><span class="o">(</span><span class="s">&#34;按住鼠标不放选择截图,双击完成截图&#34;</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">x</span> <span class="o">+</span> <span class="n">10</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">y</span> <span class="o">+</span> <span class="n">15</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 根据东南西北等八个方向决定选中的要修改的X和Y的座标
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param state 状态
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initSelect</span><span class="o">(</span><span class="n">States</span> <span class="n">state</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">switch</span> <span class="o">(</span><span class="n">state</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">EAST</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="o">(</span><span class="n">endX</span> <span class="o">&gt;</span> <span class="n">startX</span> <span class="o">?</span> <span class="n">END_X</span> <span class="o">:</span> <span class="n">START_X</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">WEST</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="o">(</span><span class="n">endX</span> <span class="o">&gt;</span> <span class="n">startX</span> <span class="o">?</span> <span class="n">START_X</span> <span class="o">:</span> <span class="n">END_X</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">NORTH</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="o">(</span><span class="n">startY</span> <span class="o">&gt;</span> <span class="n">endY</span> <span class="o">?</span> <span class="n">END_Y</span> <span class="o">:</span> <span class="n">START_Y</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">SOUTH</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="o">(</span><span class="n">startY</span> <span class="o">&gt;</span> <span class="n">endY</span> <span class="o">?</span> <span class="n">START_Y</span> <span class="o">:</span> <span class="n">END_Y</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">NORTH_EAST</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="o">(</span><span class="n">startY</span> <span class="o">&gt;</span> <span class="n">endY</span> <span class="o">?</span> <span class="n">END_Y</span> <span class="o">:</span> <span class="n">START_Y</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="o">(</span><span class="n">endX</span> <span class="o">&gt;</span> <span class="n">startX</span> <span class="o">?</span> <span class="n">END_X</span> <span class="o">:</span> <span class="n">START_X</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">NORTH_WEST</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="o">(</span><span class="n">startY</span> <span class="o">&gt;</span> <span class="n">endY</span> <span class="o">?</span> <span class="n">END_Y</span> <span class="o">:</span> <span class="n">START_Y</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="o">(</span><span class="n">endX</span> <span class="o">&gt;</span> <span class="n">startX</span> <span class="o">?</span> <span class="n">START_X</span> <span class="o">:</span> <span class="n">END_X</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">SOUTH_EAST</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="o">(</span><span class="n">startY</span> <span class="o">&gt;</span> <span class="n">endY</span> <span class="o">?</span> <span class="n">START_Y</span> <span class="o">:</span> <span class="n">END_Y</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="o">(</span><span class="n">endX</span> <span class="o">&gt;</span> <span class="n">startX</span> <span class="o">?</span> <span class="n">END_X</span> <span class="o">:</span> <span class="n">START_X</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">SOUTH_WEST</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="o">(</span><span class="n">startY</span> <span class="o">&gt;</span> <span class="n">endY</span> <span class="o">?</span> <span class="n">START_Y</span> <span class="o">:</span> <span class="n">END_Y</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="o">(</span><span class="n">endX</span> <span class="o">&gt;</span> <span class="n">startX</span> <span class="o">?</span> <span class="n">START_X</span> <span class="o">:</span> <span class="n">END_X</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="n">DEFAULT</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentX</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">currentY</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 鼠标移动对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param me 事件对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseMoved</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">doMouseMoved</span><span class="o">(</span><span class="n">me</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">initSelect</span><span class="o">(</span><span class="n">current</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">showTip</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">p</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getPoint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">repaint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 处理鼠标移动,是为了每次都能初始化一下所要选择的区域
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param me 鼠标事件对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">doMouseMoved</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">select</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">me</span><span class="o">.</span><span class="na">getPoint</span><span class="o">()))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">setCursor</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">MOVE_CURSOR</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">                <span class="n">current</span> <span class="o">=</span> <span class="n">States</span><span class="o">.</span><span class="na">MOVE</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">States</span><span class="o">[]</span> <span class="n">st</span> <span class="o">=</span> <span class="n">States</span><span class="o">.</span><span class="na">values</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">rec</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="o">(</span><span class="n">rec</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">contains</span><span class="o">(</span><span class="n">me</span><span class="o">.</span><span class="na">getPoint</span><span class="o">()))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">current</span> <span class="o">=</span> <span class="n">st</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">                        <span class="k">this</span><span class="o">.</span><span class="na">setCursor</span><span class="o">(</span><span class="n">st</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getCursor</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">this</span><span class="o">.</span><span class="na">setCursor</span><span class="o">(</span><span class="n">cs</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">current</span> <span class="o">=</span> <span class="n">States</span><span class="o">.</span><span class="na">DEFAULT</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseExited</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseEntered</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 鼠标拖拽对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param me 事件对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseDragged</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getX</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getY</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 分别处理一系列的（光标）状态（枚举值）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">MOVE</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">startX</span> <span class="o">+=</span> <span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">tempX</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">startY</span> <span class="o">+=</span> <span class="o">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">tempY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">endX</span> <span class="o">+=</span> <span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">tempX</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">endY</span> <span class="o">+=</span> <span class="o">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">tempY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">tempX</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">tempY</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">EAST</span> <span class="o">||</span> <span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">WEST</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">currentX</span> <span class="o">==</span> <span class="n">START_X</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">startX</span> <span class="o">+=</span> <span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">tempX</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempX</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">endX</span> <span class="o">+=</span> <span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">tempX</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempX</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">NORTH</span> <span class="o">||</span> <span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">currentY</span> <span class="o">==</span> <span class="n">START_Y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">startY</span> <span class="o">+=</span> <span class="o">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">tempY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempY</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">endY</span> <span class="o">+=</span> <span class="o">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">tempY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempY</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">NORTH_EAST</span> <span class="o">||</span> <span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">SOUTH_EAST</span> <span class="o">||</span> <span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">SOUTH_WEST</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">currentY</span> <span class="o">==</span> <span class="n">START_Y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">startY</span> <span class="o">+=</span> <span class="o">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">tempY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempY</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">endY</span> <span class="o">+=</span> <span class="o">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">tempY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempY</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">currentX</span> <span class="o">==</span> <span class="n">START_X</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">startX</span> <span class="o">+=</span> <span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">tempX</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempX</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">endX</span> <span class="o">+=</span> <span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">tempX</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">tempX</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">startX</span> <span class="o">=</span> <span class="n">tempX</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">startY</span> <span class="o">=</span> <span class="n">tempY</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">endX</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getX</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">endY</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getY</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">repaint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 鼠标按压事件
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param me 事件对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mousePressed</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">showTip</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">tempX</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getX</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">tempY</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getY</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 鼠标释放事件
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param me 事件对象
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseReleased</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 鼠标右键
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">me</span><span class="o">.</span><span class="na">isPopupTrigger</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">current</span> <span class="o">==</span> <span class="n">States</span><span class="o">.</span><span class="na">MOVE</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">showTip</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">p</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="na">getPoint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">startX</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">startY</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">endX</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">endY</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">repaint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">jf</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">updates</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 鼠标点击事件
</span></span></span><span class="line"><span class="cl"><span class="cm">         *
</span></span></span><span class="line"><span class="cl"><span class="cm">         * @param me 事件
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mouseClicked</span><span class="o">(</span><span class="n">MouseEvent</span> <span class="n">me</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 双击左键触发事件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">me</span><span class="o">.</span><span class="na">getClickCount</span><span class="o">()</span> <span class="o">==</span> <span class="n">2</span> <span class="o">&amp;&amp;</span> <span class="n">select</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">me</span><span class="o">.</span><span class="na">getPoint</span><span class="o">()))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">select</span><span class="o">.</span><span class="na">x</span> <span class="o">+</span> <span class="n">select</span><span class="o">.</span><span class="na">width</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">select</span><span class="o">.</span><span class="na">y</span> <span class="o">+</span> <span class="n">select</span><span class="o">.</span><span class="na">height</span> <span class="o">&lt;</span> <span class="k">this</span><span class="o">.</span><span class="na">getHeight</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">get</span> <span class="o">=</span> <span class="n">bi</span><span class="o">.</span><span class="na">getSubimage</span><span class="o">(</span><span class="n">select</span><span class="o">.</span><span class="na">x</span><span class="o">,</span> <span class="n">select</span><span class="o">.</span><span class="na">y</span><span class="o">,</span> <span class="n">select</span><span class="o">.</span><span class="na">width</span><span class="o">,</span> <span class="n">select</span><span class="o">.</span><span class="na">height</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">jf</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">updates</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="kt">int</span> <span class="n">wid</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="na">width</span><span class="o">,</span> <span class="n">het</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="na">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">select</span><span class="o">.</span><span class="na">x</span> <span class="o">+</span> <span class="n">select</span><span class="o">.</span><span class="na">width</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="o">.</span><span class="na">getWidth</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">wid</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">-</span> <span class="n">select</span><span class="o">.</span><span class="na">x</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">select</span><span class="o">.</span><span class="na">y</span> <span class="o">+</span> <span class="n">select</span><span class="o">.</span><span class="na">height</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="o">.</span><span class="na">getHeight</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">het</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getHeight</span><span class="o">()</span> <span class="o">-</span> <span class="n">select</span><span class="o">.</span><span class="na">y</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">get</span> <span class="o">=</span> <span class="n">bi</span><span class="o">.</span><span class="na">getSubimage</span><span class="o">(</span><span class="n">select</span><span class="o">.</span><span class="na">x</span><span class="o">,</span> <span class="n">select</span><span class="o">.</span><span class="na">y</span><span class="o">,</span> <span class="n">wid</span><span class="o">,</span> <span class="n">het</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">jf</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">updates</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 截屏方向状态 东西南北
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @author whitepure
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">enum</span> <span class="n">States</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">NORTH_WEST</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">NW_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">NORTH</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">N_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">NORTH_EAST</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">NE_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">EAST</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">E_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">SOUTH_EAST</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">SE_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">SOUTH</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">S_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">SOUTH_WEST</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">SW_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">WEST</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">W_RESIZE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">MOVE</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">MOVE_CURSOR</span><span class="o">)),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">DEFAULT</span><span class="o">(</span><span class="k">new</span> <span class="n">Cursor</span><span class="o">(</span><span class="n">Cursor</span><span class="o">.</span><span class="na">DEFAULT_CURSOR</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Cursor</span> <span class="n">cs</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">States</span><span class="o">(</span><span class="n">Cursor</span> <span class="n">cs</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">cs</span> <span class="o">=</span> <span class="n">cs</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Cursor</span> <span class="nf">getCursor</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">cs</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CutScreenMainStarter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SwingUtilities</span><span class="o">.</span><span class="na">invokeLater</span><span class="o">(</span><span class="n">CaptureScreen</span><span class="o">::</span><span class="k">new</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="文字转二维码">文字转二维码</h2>
<p>输入文字，生成二维码。<a href="/iblog/posts/annex/jar/qr-code.jar">点击下载</a></p>
<p><img src="/iblog/posts/annex/images/readme/readme-004.png" alt="readme-004"></p>
<h3 id="代码-2">代码</h3>
<p>需要依赖第三方类库：<a href="/iblog/posts/annex/jar/lib/qrcode.jar">点击下载</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 创建二维码
</span></span></span><span class="line"><span class="cl"><span class="cm"> *
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QRCode</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 生成二维码图像
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param context 二维码内容
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param size   二维码尺寸
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 二维码图像
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span>  <span class="n">BufferedImage</span> <span class="nf">createPassword</span><span class="o">(</span><span class="n">String</span> <span class="n">context</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">BufferedImage</span> <span class="n">buffer</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Qrcode</span> <span class="n">qrCodeHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Qrcode</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">qrCodeHandler</span><span class="o">.</span><span class="na">setQrcodeErrorCorrect</span><span class="o">(</span><span class="sc">&#39;M&#39;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">qrCodeHandler</span><span class="o">.</span><span class="na">setQrcodeEncodeMode</span><span class="o">(</span><span class="sc">&#39;B&#39;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">qrCodeHandler</span><span class="o">.</span><span class="na">setQrcodeVersion</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">byte</span><span class="o">[]</span> <span class="n">contextBytes</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">boolean</span><span class="o">[][]</span> <span class="n">codeOut</span> <span class="o">=</span> <span class="n">qrCodeHandler</span><span class="o">.</span><span class="na">calQrcode</span><span class="o">(</span><span class="n">contextBytes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 图像的尺寸 都使用一个值生成一个正方形图案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">imgSize</span> <span class="o">=</span> <span class="n">67</span> <span class="o">+</span> <span class="n">12</span> <span class="o">*</span> <span class="o">(</span><span class="n">size</span> <span class="o">-</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedImage</span><span class="o">(</span><span class="n">imgSize</span><span class="o">,</span> <span class="n">imgSize</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Graphics2D</span> <span class="n">gs</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="na">createGraphics</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">gs</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">gs</span><span class="o">.</span><span class="na">setBackground</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">white</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">gs</span><span class="o">.</span><span class="na">clearRect</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">imgSize</span><span class="o">,</span> <span class="n">imgSize</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">pixOff</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">codeOut</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">codeOut</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">j</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">codeOut</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">])</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">gs</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="n">j</span> <span class="o">*</span> <span class="n">3</span> <span class="o">+</span> <span class="n">pixOff</span><span class="o">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">3</span> <span class="o">+</span> <span class="n">pixOff</span><span class="o">,</span> <span class="n">3</span><span class="o">,</span> <span class="n">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">buffer</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QRCodeFrame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">QRCodeFrame</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">init</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 一些组件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">JFrame</span> <span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFrame</span><span class="o">(</span><span class="s">&#34;生成二维码&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">13</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">panel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">imgPanel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">btn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;生成&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Border</span> <span class="n">lineBorder</span> <span class="o">=</span> <span class="n">BorderFactory</span><span class="o">.</span><span class="na">createLineBorder</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">gray</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 获取光标，使光标一直在文本框内
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">input</span><span class="o">.</span><span class="na">requestFocus</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">input</span><span class="o">.</span><span class="na">setBorder</span><span class="o">(</span><span class="n">lineBorder</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">btn</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 点击按钮执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">btn</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">getText</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="s">&#34;&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">text</span><span class="o">)){</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 刷新imgPanel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">imgPanel</span><span class="o">.</span><span class="na">removeAll</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">imgPanel</span><span class="o">.</span><span class="na">repaint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">QRCode</span> <span class="n">qrCode</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QRCode</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">BufferedImage</span> <span class="n">qrCodeImg</span> <span class="o">=</span> <span class="n">qrCode</span><span class="o">.</span><span class="na">createPassword</span><span class="o">(</span><span class="n">text</span><span class="o">,</span> <span class="n">11</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">ImageIcon</span> <span class="n">imageIcon</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageIcon</span><span class="o">(</span><span class="n">qrCodeImg</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">JLabel</span> <span class="n">label</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="n">imageIcon</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">imgPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">label</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 刷新imgPanel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">imgPanel</span><span class="o">.</span><span class="na">updateUI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">NORTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">imgPanel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">(</span><span class="n">FlowLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setBounds</span><span class="o">(</span><span class="n">600</span><span class="o">,</span><span class="n">250</span><span class="o">,</span><span class="n">300</span><span class="o">,</span><span class="n">280</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setAlwaysOnTop</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setResizable</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QRCodeMainStarter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">QRCodeFrame</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="英文翻译器">英文翻译器</h2>
<p>将英文翻译为中文,仅支持单词、短语翻译，程序默认加载自带的英语字典，如果您想要修改字典可在源代码中进行配置或在程序运行时指定字典路径。<a href="/iblog/posts/annex/jar/english-translation.jar">点击下载</a></p>
<p><img src="/iblog/posts/annex/images/readme/readme-005.png" alt="readme-005"></p>
<h3 id="代码-3">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 参考：https://www.jb51.net/article/163917.htm 有改动
</span></span></span><span class="line"><span class="cl"><span class="cm"> * &lt;p&gt;
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 暂时可翻译单词，需要手动录入词典；暂时不能翻译英文句子需要写一些语法判断，比如动词后面跟名词，倒装句结构等等。
</span></span></span><span class="line"><span class="cl"><span class="cm"> *
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @author whitepure
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnglishTranslation</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Properties</span> <span class="n">pps</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">EnglishTranslation</span><span class="o">(</span><span class="n">String</span> <span class="n">dictPath</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">loadDict</span><span class="o">(</span><span class="n">dictPath</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 加载词典
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param dictPath 词典路径
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">loadDict</span><span class="o">(</span><span class="n">String</span> <span class="n">dictPath</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">dictPath</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="s">&#34;&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">dictPath</span><span class="o">)</span> <span class="o">||</span> <span class="o">!(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">dictPath</span><span class="o">).</span><span class="na">exists</span><span class="o">()))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;加载词典文件不存在&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">pps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 以字符载入时没有乱码，以字节载入时出现了乱码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">try</span> <span class="o">(</span><span class="n">FileReader</span> <span class="n">fis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">dictPath</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">pps</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">fis</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;载入词库时出错&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 翻译将待翻译的去词典中去找然后在返回
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param data 待翻译的数据
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 翻译后的数据
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">translation</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">srcTxt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">dstTxt</span> <span class="o">=</span> <span class="n">srcTxt</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">delim</span> <span class="o">=</span> <span class="s">&#34; ,.!?%$*()\n\t&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">StringTokenizer</span> <span class="n">st</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">srcTxt</span><span class="o">,</span> <span class="n">delim</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">sub</span><span class="o">,</span> <span class="n">lowerSub</span><span class="o">,</span> <span class="n">newSub</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 获取待翻译的单词
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">sub</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 将单词转化为小写
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">lowerSub</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 从词典中寻找中文对应的单词
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">newSub</span> <span class="o">=</span> <span class="n">pps</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="n">lowerSub</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">newSub</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 只替换第一个，即只替换了当前的字符串，否则容易造成翻译错误，如 china 翻译为 ch我na
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">dstTxt</span> <span class="o">=</span> <span class="n">dstTxt</span><span class="o">.</span><span class="na">replaceFirst</span><span class="o">(</span><span class="n">sub</span><span class="o">,</span> <span class="n">newSub</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">dstTxt</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">,</span> <span class="s">&#34;&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * GUI翻译组件
</span></span></span><span class="line"><span class="cl"><span class="cm"> *
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @author whitepure
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TranslationFrame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">EnglishTranslation</span> <span class="n">englishTranslation</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">TranslationFrame</span><span class="o">(</span><span class="n">String</span> <span class="n">dictPath</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">englishTranslation</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EnglishTranslation</span><span class="o">(</span><span class="n">dictPath</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">init</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 初始化gui组件
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 一些组件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">JFrame</span> <span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFrame</span><span class="o">(</span><span class="s">&#34;英语翻译&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">panel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">btn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;翻译&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextArea</span> <span class="n">textArea</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextArea</span><span class="o">(</span><span class="n">4</span><span class="o">,</span><span class="n">27</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Border</span> <span class="n">lineBorder</span> <span class="o">=</span> <span class="n">BorderFactory</span><span class="o">.</span><span class="na">createLineBorder</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">gray</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">textArea</span><span class="o">.</span><span class="na">setBorder</span><span class="o">(</span><span class="n">lineBorder</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 获取光标，使光标一直在文本框内
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">input</span><span class="o">.</span><span class="na">requestFocus</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">input</span><span class="o">.</span><span class="na">setBorder</span><span class="o">(</span><span class="n">lineBorder</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">btn</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">NORTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">textArea</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 点击翻译按钮执行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">btn</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">getText</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="s">&#34;&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">text</span><span class="o">)){</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">translationText</span> <span class="o">=</span> <span class="n">englishTranslation</span><span class="o">.</span><span class="na">translation</span><span class="o">(</span><span class="n">text</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;%s 译为 %s \n&#34;</span><span class="o">,</span><span class="n">text</span><span class="o">,</span><span class="n">translationText</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">textArea</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">translationText</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">(</span><span class="n">FlowLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setBounds</span><span class="o">(</span><span class="n">600</span><span class="o">,</span><span class="n">250</span><span class="o">,</span><span class="n">355</span><span class="o">,</span><span class="n">160</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setAlwaysOnTop</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setResizable</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TranslationMainStarter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Scanner</span> <span class="n">scanner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;请输入字典的全路径，例如：/Users/whitepure/IdeaProjects/gadget/out/production/english-translation/io/github/whitepure/dict.txt&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="o">(</span><span class="n">scanner</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">dictPath</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;键盘输入的内容是：&#34;</span><span class="o">+</span> <span class="n">dictPath</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">path</span> <span class="o">=</span> <span class="n">dictPath</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">path</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="s">&#34;&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">path</span><span class="o">)){</span>
</span></span><span class="line"><span class="cl">            <span class="n">path</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TranslationMainStarter</span><span class="o">().</span><span class="na">getDefaultLoadPath</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">TranslationFrame</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 加载词典文件加载到内存
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 词典路径
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="nf">getDefaultLoadPath</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">final</span> <span class="n">String</span> <span class="n">dictPath</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getResource</span><span class="o">(</span><span class="s">&#34;&#34;</span><span class="o">)).</span><span class="na">getPath</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;file.separator&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                <span class="o">+</span> <span class="s">&#34;dict.txt&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;当前词典加载路径：&#34;</span> <span class="o">+</span> <span class="n">dictPath</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">dictPath</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>字典文件dict.txt</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">i=我
</span></span><span class="line"><span class="cl">me=我
</span></span><span class="line"><span class="cl">myself=我
</span></span><span class="line"><span class="cl">he=他
</span></span><span class="line"><span class="cl">him=他
</span></span><span class="line"><span class="cl">she=她
</span></span><span class="line"><span class="cl">it=它
</span></span><span class="line"><span class="cl">they=它们
</span></span><span class="line"><span class="cl">us=我们
</span></span><span class="line"><span class="cl">our=我们
</span></span><span class="line"><span class="cl">we=我们
</span></span><span class="line"><span class="cl">her=她的
</span></span><span class="line"><span class="cl">his=他的
</span></span><span class="line"><span class="cl">them=他们
</span></span><span class="line"><span class="cl">you=你
</span></span><span class="line"><span class="cl">thee=你
</span></span><span class="line"><span class="cl">thou=你
</span></span><span class="line"><span class="cl">your=你的
</span></span><span class="line"><span class="cl">my=我的
</span></span><span class="line"><span class="cl">and=并且
</span></span><span class="line"><span class="cl">hello=你好
</span></span><span class="line"><span class="cl">world=世界
</span></span><span class="line"><span class="cl">love=爱
</span></span><span class="line"><span class="cl">china=中国
</span></span><span class="line"><span class="cl">chinese=中国人
</span></span></code></pre></div><h2 id="提色器">提色器</h2>
<p>按住alt（macOS用户按住option）鼠标滑动即可获取当前位置颜色。<a href="/iblog/posts/annex/jar/english-translation.jar">点击下载</a></p>
<p><img src="/iblog/posts/annex/images/readme/readme-006.png" alt="readme-006"></p>
<h3 id="代码-4">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExtracterFrame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">ExtracterFrame</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">init</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 初始化
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 窗口组件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">JFrame</span> <span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFrame</span><span class="o">(</span><span class="s">&#34;提色器&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">rgbPanel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">colorPanel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// rgb 组件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">JLabel</span> <span class="n">labelR</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="s">&#34;R：&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JLabel</span> <span class="n">labelG</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="s">&#34;G：&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JLabel</span> <span class="n">labelB</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="s">&#34;B：&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">txtR</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">txtG</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">txtB</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">rgbPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">labelR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rgbPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">txtR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rgbPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">labelG</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rgbPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">txtG</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rgbPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">labelB</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rgbPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">txtB</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 展示颜色组件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">JLabel</span> <span class="n">labelHex</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="s">&#34;16进制:&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">txtHex</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">8</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">colorTxt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">colorTxt</span><span class="o">.</span><span class="na">setBackground</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">BLACK</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">colorPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">labelHex</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">colorPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">txtHex</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">colorPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">colorTxt</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">class</span> <span class="nc">ExtractKeyListener</span> <span class="kd">implements</span> <span class="n">KeyListener</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">keyTyped</span><span class="o">(</span><span class="n">KeyEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">keyPressed</span><span class="o">(</span><span class="n">KeyEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">keyReleased</span><span class="o">(</span><span class="n">KeyEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getKeyCode</span><span class="o">()</span> <span class="o">==</span> <span class="n">18</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Robot</span> <span class="n">robot</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">robot</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Robot</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">AWTException</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;提取颜色失败&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">exception</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Point</span> <span class="n">point</span> <span class="o">=</span> <span class="n">MouseInfo</span><span class="o">.</span><span class="na">getPointerInfo</span><span class="o">().</span><span class="na">getLocation</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Color</span> <span class="n">pixelColor</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="na">getPixelColor</span><span class="o">(</span><span class="n">point</span><span class="o">.</span><span class="na">x</span><span class="o">,</span> <span class="n">point</span><span class="o">.</span><span class="na">y</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="kt">int</span> <span class="n">red</span> <span class="o">=</span> <span class="n">pixelColor</span><span class="o">.</span><span class="na">getRed</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">int</span> <span class="n">green</span> <span class="o">=</span> <span class="n">pixelColor</span><span class="o">.</span><span class="na">getGreen</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">int</span> <span class="n">blue</span> <span class="o">=</span> <span class="n">pixelColor</span><span class="o">.</span><span class="na">getBlue</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">txtR</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">red</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">                    <span class="n">txtG</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">green</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">                    <span class="n">txtB</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">blue</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">colorTxt</span><span class="o">.</span><span class="na">setBackground</span><span class="o">(</span><span class="n">pixelColor</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">txtHex</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;#&#34;</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">red</span><span class="o">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">green</span><span class="o">)</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">blue</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 监听键盘事件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">ExtractKeyListener</span> <span class="n">extractKeyListener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ExtractKeyListener</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">txtR</span><span class="o">.</span><span class="na">addKeyListener</span><span class="o">(</span><span class="n">extractKeyListener</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">txtG</span><span class="o">.</span><span class="na">addKeyListener</span><span class="o">(</span><span class="n">extractKeyListener</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">txtB</span><span class="o">.</span><span class="na">addKeyListener</span><span class="o">(</span><span class="n">extractKeyListener</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">colorTxt</span><span class="o">.</span><span class="na">addKeyListener</span><span class="o">(</span><span class="n">extractKeyListener</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 添加panel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">frame</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">rgbPanel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">NORTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">colorPanel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">(</span><span class="n">FlowLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setBounds</span><span class="o">(</span><span class="n">600</span><span class="o">,</span> <span class="n">250</span><span class="o">,</span> <span class="n">250</span><span class="o">,</span> <span class="n">120</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setAlwaysOnTop</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setResizable</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExtractColorMainStarter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">ExtracterFrame</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="图片水印生成器">图片水印生成器</h2>
<p>加载图片，输入水印内容，在加载图片的右下会生成红色水印。<a href="/iblog/posts/annex/jar/img-watermarking.jar">点击下载</a></p>
<p><img src="/iblog/posts/annex/images/readme/readme-007.png" alt="readme-007"></p>
<h3 id="代码-5">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ImgWatermarking</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 给图片添加水印文字、可设置水印文字的旋转角度
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param logoText   水印文本
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param srcImgPath 原图片路径
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param degree     旋转角度，如果不旋转设置为 null
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">BufferedImage</span> <span class="nf">createImgWatermarking</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">logoText</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">srcImgPath</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Integer</span> <span class="n">degree</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Color</span> <span class="n">color</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">Font</span> <span class="n">font</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="kt">float</span> <span class="n">alpha</span>
</span></span><span class="line"><span class="cl">    <span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">==</span> <span class="n">0</span> <span class="o">?</span> <span class="n">0</span><span class="o">.</span><span class="na">5f</span> <span class="o">:</span> <span class="n">alpha</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">font</span> <span class="o">=</span> <span class="n">font</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="k">new</span> <span class="n">Font</span><span class="o">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="o">,</span> <span class="n">Font</span><span class="o">.</span><span class="na">PLAIN</span><span class="o">,</span> <span class="n">35</span><span class="o">)</span> <span class="o">:</span> <span class="n">font</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">Color</span><span class="o">.</span><span class="na">red</span> <span class="o">:</span> <span class="n">color</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;生成图片=》图片路径：&#34;</span> <span class="o">+</span> <span class="n">srcImgPath</span> <span class="o">+</span> <span class="s">&#34; 水印内容=》&#34;</span> <span class="o">+</span> <span class="n">logoText</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Image</span> <span class="n">srcImg</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">srcImg</span> <span class="o">=</span> <span class="n">ImageIO</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">srcImgPath</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;读取文件失败&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">srcImg</span><span class="o">.</span><span class="na">getWidth</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="n">srcImg</span><span class="o">.</span><span class="na">getHeight</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">BufferedImage</span> <span class="n">buffImg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedImage</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">,</span> <span class="n">BufferedImage</span><span class="o">.</span><span class="na">TYPE_INT_RGB</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 拿到画笔对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Graphics2D</span> <span class="n">g</span> <span class="o">=</span> <span class="n">buffImg</span><span class="o">.</span><span class="na">createGraphics</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置水印
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">g</span><span class="o">.</span><span class="na">setRenderingHint</span><span class="o">(</span><span class="n">RenderingHints</span><span class="o">.</span><span class="na">KEY_INTERPOLATION</span><span class="o">,</span> <span class="n">RenderingHints</span><span class="o">.</span><span class="na">VALUE_INTERPOLATION_BILINEAR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="o">.</span><span class="na">drawImage</span><span class="o">(</span><span class="n">srcImg</span><span class="o">.</span><span class="na">getScaledInstance</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">,</span> <span class="n">Image</span><span class="o">.</span><span class="na">SCALE_SMOOTH</span><span class="o">),</span> <span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置水印旋转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="kc">null</span> <span class="o">!=</span> <span class="n">degree</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="o">.</span><span class="na">rotate</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">toRadians</span><span class="o">(</span><span class="n">degree</span><span class="o">),</span> <span class="o">(</span><span class="n">buffImg</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">),</span> <span class="o">(</span><span class="n">buffImg</span><span class="o">.</span><span class="na">getHeight</span><span class="o">()</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置水印
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="n">color</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="o">.</span><span class="na">setFont</span><span class="o">(</span><span class="n">font</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="o">.</span><span class="na">setComposite</span><span class="o">(</span><span class="n">AlphaComposite</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">AlphaComposite</span><span class="o">.</span><span class="na">SRC_ATOP</span><span class="o">,</span> <span class="n">alpha</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">logoText</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">*</span> <span class="n">font</span><span class="o">.</span><span class="na">getSize</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">font</span><span class="o">.</span><span class="na">getSize</span><span class="o">()</span> <span class="o">*</span> <span class="n">2</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="o">.</span><span class="na">drawString</span><span class="o">(</span><span class="n">logoText</span><span class="o">,</span> <span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">0</span><span class="o">),</span> <span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="n">0</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">buffImg</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @author whitepure
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WatermarkingFrame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">WatermarkingFrame</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">init</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 初始化
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 一些组件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">JFrame</span> <span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFrame</span><span class="o">(</span><span class="s">&#34;生成水印&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JTextField</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JTextField</span><span class="o">(</span><span class="n">13</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">panel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JPanel</span> <span class="n">imgPanel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JPanel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">createBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;生成&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">loadImgBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;加载图片&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">JButton</span> <span class="n">saveAs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JButton</span><span class="o">(</span><span class="s">&#34;另存为&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Border</span> <span class="n">lineBorder</span> <span class="o">=</span> <span class="n">BorderFactory</span><span class="o">.</span><span class="na">createLineBorder</span><span class="o">(</span><span class="n">Color</span><span class="o">.</span><span class="na">gray</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 获取光标，使光标一直在文本框内
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">input</span><span class="o">.</span><span class="na">requestFocus</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">input</span><span class="o">.</span><span class="na">setBorder</span><span class="o">(</span><span class="n">lineBorder</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">saveAs</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">createBtn</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">loadImgBtn</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 图片路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">String</span><span class="o">[]</span> <span class="n">imgPath</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">1</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 用于另存为的图片
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">final</span> <span class="n">BufferedImage</span><span class="o">[]</span> <span class="n">waterMarkingImg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedImage</span><span class="o">[</span><span class="n">1</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 屏幕的尺寸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Dimension</span> <span class="n">screenSize</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">getDefaultToolkit</span><span class="o">().</span><span class="na">getScreenSize</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 点击按钮加载图片
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">loadImgBtn</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">JFileChooser</span> <span class="n">jfc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JFileChooser</span><span class="o">(</span><span class="n">FileSystemView</span><span class="o">.</span><span class="na">getFileSystemView</span><span class="o">().</span><span class="na">getHomeDirectory</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">jfc</span><span class="o">.</span><span class="na">setDialogTitle</span><span class="o">(</span><span class="s">&#34;选择图片&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">jfc</span><span class="o">.</span><span class="na">setAcceptAllFileFilterUsed</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">FileNameExtensionFilter</span> <span class="n">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileNameExtensionFilter</span><span class="o">(</span><span class="s">&#34;PNG and JPG images&#34;</span><span class="o">,</span> <span class="s">&#34;png&#34;</span><span class="o">,</span> <span class="s">&#34;jpg&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">jfc</span><span class="o">.</span><span class="na">addChoosableFileFilter</span><span class="o">(</span><span class="n">filter</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">returnValue</span> <span class="o">=</span> <span class="n">jfc</span><span class="o">.</span><span class="na">showOpenDialog</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 获取图片路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">returnValue</span> <span class="o">==</span> <span class="n">JFileChooser</span><span class="o">.</span><span class="na">APPROVE_OPTION</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">jfc</span><span class="o">.</span><span class="na">getSelectedFile</span><span class="o">().</span><span class="na">getPath</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">imgPath</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">path</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">jfc</span><span class="o">.</span><span class="na">getSelectedFile</span><span class="o">().</span><span class="na">getPath</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">File</span> <span class="n">sourceImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">BufferedImage</span> <span class="n">image</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">image</span> <span class="o">=</span> <span class="n">ImageIO</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">sourceImage</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;图片加载失败&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="s">&#34;图片加载失败,&#34;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="s">&#34;提示&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">PLAIN_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 刷新imgPanel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">imgPanel</span><span class="o">.</span><span class="na">removeAll</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">imgPanel</span><span class="o">.</span><span class="na">repaint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 将图片放入到数组中，用于另存为保存该图片
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">waterMarkingImg</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">image</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="na">getWidth</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="na">getHeight</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">ImageIcon</span> <span class="n">imageIcon</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageIcon</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">imageIcon</span><span class="o">.</span><span class="na">setImage</span><span class="o">(</span><span class="n">imageIcon</span><span class="o">.</span><span class="na">getImage</span><span class="o">().</span><span class="na">getScaledInstance</span><span class="o">(</span><span class="n">width</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">,</span> <span class="n">height</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">,</span> <span class="n">Image</span><span class="o">.</span><span class="na">SCALE_DEFAULT</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="n">JLabel</span> <span class="n">label</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="n">imageIcon</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">imgPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">label</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 刷新imgPanel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">imgPanel</span><span class="o">.</span><span class="na">updateUI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">frame</span><span class="o">.</span><span class="na">setBounds</span><span class="o">(((</span><span class="n">screenSize</span><span class="o">.</span><span class="na">width</span> <span class="o">-</span> <span class="o">(</span><span class="n">width</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">))</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">)</span> <span class="o">,</span> <span class="o">((</span><span class="n">screenSize</span><span class="o">.</span><span class="na">height</span> <span class="o">-</span> <span class="o">(</span><span class="n">height</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">))</span> <span class="o">&gt;&gt;</span> <span class="n">2</span><span class="o">),</span> <span class="n">Math</span><span class="o">.</span><span class="na">max</span><span class="o">((</span><span class="n">width</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">),</span> <span class="n">450</span><span class="o">),</span> <span class="o">(</span><span class="n">height</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">)</span> <span class="o">+</span> <span class="n">90</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 点击按钮生成水印
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">createBtn</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">input</span><span class="o">.</span><span class="na">getText</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">text</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="s">&#34;&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">text</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;水印内容为空&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="s">&#34;水印内容为空&#34;</span><span class="o">,</span> <span class="s">&#34;提示&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">WARNING_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">imgPath</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="s">&#34;未加载图片&#34;</span><span class="o">,</span> <span class="s">&#34;提示&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">WARNING_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;未加载图片&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">BufferedImage</span> <span class="n">imgWatermarking</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImgWatermarking</span><span class="o">().</span><span class="na">createImgWatermarking</span><span class="o">(</span><span class="n">text</span><span class="o">,</span> <span class="n">imgPath</span><span class="o">[</span><span class="n">0</span><span class="o">],</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 刷新imgPanel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">imgPanel</span><span class="o">.</span><span class="na">removeAll</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">imgPanel</span><span class="o">.</span><span class="na">repaint</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 保存图片用于另存为
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">waterMarkingImg</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">imgWatermarking</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">imgWatermarking</span><span class="o">.</span><span class="na">getWidth</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="n">imgWatermarking</span><span class="o">.</span><span class="na">getHeight</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">ImageIcon</span> <span class="n">imageIcon</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageIcon</span><span class="o">(</span><span class="n">imgWatermarking</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">imageIcon</span><span class="o">.</span><span class="na">setImage</span><span class="o">(</span><span class="n">imageIcon</span><span class="o">.</span><span class="na">getImage</span><span class="o">().</span><span class="na">getScaledInstance</span><span class="o">(</span><span class="n">width</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">,</span> <span class="n">height</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">,</span> <span class="n">Image</span><span class="o">.</span><span class="na">SCALE_DEFAULT</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="n">JLabel</span> <span class="n">label</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">(</span><span class="n">imageIcon</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">imgPanel</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">label</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 刷新imgPanel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">imgPanel</span><span class="o">.</span><span class="na">updateUI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 点击另存为
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">saveAs</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">BufferedImage</span> <span class="n">image</span> <span class="o">=</span> <span class="n">waterMarkingImg</span><span class="o">[</span><span class="n">0</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">image</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="s">&#34;未加载图片&#34;</span><span class="o">,</span> <span class="s">&#34;提示&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">WARNING_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">FileDialog</span> <span class="n">fd</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileDialog</span><span class="o">(</span><span class="n">frame</span><span class="o">,</span> <span class="s">&#34;另存为&#34;</span><span class="o">,</span> <span class="n">FileDialog</span><span class="o">.</span><span class="na">SAVE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">fd</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 获取路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">String</span> <span class="n">directory</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="na">getDirectory</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 获取文件名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="na">getFile</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">(</span><span class="n">OutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">directory</span> <span class="o">+</span> <span class="n">fileName</span><span class="o">);)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 将图片输出到文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">ImageIO</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">image</span><span class="o">,</span> <span class="s">&#34;jpg&#34;</span><span class="o">,</span> <span class="n">out</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;另存为图片失败&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showMessageDialog</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="s">&#34;另存为图片失败,&#34;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="s">&#34;提示&#34;</span><span class="o">,</span> <span class="n">JOptionPane</span><span class="o">.</span><span class="na">PLAIN_MESSAGE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">panel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">NORTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">getContentPane</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">imgPanel</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">SOUTH</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">(</span><span class="n">FlowLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setBounds</span><span class="o">(</span><span class="n">screenSize</span><span class="o">.</span><span class="na">width</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">,</span> <span class="n">screenSize</span><span class="o">.</span><span class="na">height</span> <span class="o">&gt;&gt;</span> <span class="n">2</span><span class="o">,</span> <span class="n">450</span><span class="o">,</span> <span class="n">80</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setAlwaysOnTop</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setDefaultCloseOperation</span><span class="o">(</span><span class="n">JFrame</span><span class="o">.</span><span class="na">EXIT_ON_CLOSE</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setResizable</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ImgWatermarkingMainStarter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">WatermarkingFrame</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="huffman压缩">huffman压缩</h2>
<p>采用huffman算法对文件进行无损压缩，目前仅支持压缩单个文件，压缩好的文件以<code>.huf</code>后缀结尾,会与被压缩文件放在相同目录下。<a href="/iblog/posts/annex/jar/huffman-zip.jar">点击下载</a></p>
<p><img src="/iblog/posts/annex/images/readme/readme-008.png" alt="readme-008"></p>
<h3 id="代码-6">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">HuffmanCode</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 存放 huffman 编码表
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">huffmanCodes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="nf">getHuffmanCodesTab</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">huffmanCodes</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 将文件解码或将文件压缩
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param zipFile 原文件
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param dstFile 目标文件
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">zipOrUnZip</span><span class="o">(</span><span class="n">String</span> <span class="n">zipFile</span><span class="o">,</span> <span class="n">String</span> <span class="n">dstFile</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 生成 huffman 编码 压缩
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param bytes 将传入的文件转成字节传入
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 将传入字节转换为huffman压缩后的字节数组
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">encode</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">buildHuffmanNodes</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Node</span> <span class="n">huffmanTreeRoot</span> <span class="o">=</span> <span class="n">buildHuffmanTree</span><span class="o">(</span><span class="n">nodes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">huffmanCodes</span> <span class="o">=</span> <span class="n">buildHuffmanCodeTab</span><span class="o">(</span><span class="n">huffmanTreeRoot</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">zip</span><span class="o">(</span><span class="n">bytes</span><span class="o">,</span> <span class="n">huffmanCodes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 将 huffman编码解码，解压缩
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param huffmanCodes huffman编码表
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param huffmanBytes 待解码的huffman编码（byte数组类型）
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 解码后的
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">decode</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">huffmanCodes</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">huffmanBytes</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 将byte数组转成二进制的字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">huffmanBytes</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="n">1</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">byte</span> <span class="n">b</span> <span class="o">=</span> <span class="n">huffmanBytes</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">strToAppend</span> <span class="o">=</span> <span class="n">byteToBitString</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 判断是不是最后一个字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">boolean</span> <span class="n">isLastByte</span> <span class="o">=</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">huffmanBytes</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="n">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">isLastByte</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 得到最后一个字节的有效位数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="kt">byte</span> <span class="n">validBits</span> <span class="o">=</span> <span class="n">huffmanBytes</span><span class="o">[</span><span class="n">huffmanBytes</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="n">1</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">                <span class="n">strToAppend</span> <span class="o">=</span> <span class="n">strToAppend</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">validBits</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">strToAppend</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 将huffman编码key，val反转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Byte</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="n">huffmanCodes</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">key</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建要给集合，存放byte
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">Byte</span> <span class="n">b</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 根据huffman编码表来匹配Huffman编码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">while</span> <span class="o">(</span><span class="n">flag</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">count</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">b</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">b</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// 没有匹配到
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="n">count</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// 匹配到
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="n">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">i</span> <span class="o">+=</span> <span class="n">count</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="kt">byte</span><span class="o">[]</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">()];</span>
</span></span><span class="line"><span class="cl">        <span class="n">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">length</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">b</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 计算传入字节数组中每个字符出现的次数
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 在Node对象中添加对应的值
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param bytes 传入字节数组
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return list
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="nf">buildHuffmanNodes</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">nodes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 利用map记录集合中元素出现的次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">counts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">b</span> <span class="o">:</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">counts</span><span class="o">.</span><span class="na">merge</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">1</span><span class="o">,</span> <span class="n">Integer</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 把每一个键值对转成一个Node 对象，并加入到nodes集合
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">counts</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">nodes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Node</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">nodes</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 构建Huffman树
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param nodes 传入统计好的 每个字符出现的次数,即{@method buildHuffmanNodes}方法执行完毕
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 构建好Huffman的根结点
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Node</span> <span class="nf">buildHuffmanTree</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">nodes</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="o">(</span><span class="n">nodes</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 排序, 从小到大
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">nodes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 取出第一颗最小的二叉树
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Node</span> <span class="n">leftNode</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 取出第二颗最小的二叉树
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Node</span> <span class="n">rightNode</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 创建一颗新的二叉树,它的根节点 没有data, 只有权值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Node</span> <span class="n">parent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">leftNode</span><span class="o">.</span><span class="na">weight</span> <span class="o">+</span> <span class="n">rightNode</span><span class="o">.</span><span class="na">weight</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">parent</span><span class="o">.</span><span class="na">left</span> <span class="o">=</span> <span class="n">leftNode</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">parent</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="n">rightNode</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 将已经处理的两颗二叉树从nodes删除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">nodes</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">leftNode</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">nodes</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">rightNode</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 将新的二叉树，加入到nodes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">nodes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// nodes 最后的结点，就是赫夫曼树的根结点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">nodes</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 构建huffman编码表
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param root huffman root结点
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 返回一个Huffman编码表
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="nf">buildHuffmanCodeTab</span><span class="o">(</span><span class="n">Node</span> <span class="n">root</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">root</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 处理root的左子树
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">buildHuffmanCodeTab</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">,</span> <span class="s">&#34;0&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 处理root的右子树
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">buildHuffmanCodeTab</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">,</span> <span class="s">&#34;1&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">huffmanCodes</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">buildHuffmanCodeTab</span><span class="o">(</span><span class="n">Node</span> <span class="n">node</span><span class="o">,</span> <span class="n">String</span> <span class="n">code</span><span class="o">,</span> <span class="n">StringBuilder</span> <span class="n">stringBuilder</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">StringBuilder</span> <span class="n">curNodeCode</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">(</span><span class="n">stringBuilder</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">curNodeCode</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">code</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">node</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 判断当前node 是叶子结点还是非叶子结点，如果 node.data == null 为非叶子结点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">data</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 向左递归
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">buildHuffmanCodeTab</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">,</span> <span class="s">&#34;0&#34;</span><span class="o">,</span> <span class="n">curNodeCode</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 向右递归
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">buildHuffmanCodeTab</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">,</span> <span class="s">&#34;1&#34;</span><span class="o">,</span> <span class="n">curNodeCode</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 表示找到某个叶子结点的最后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">huffmanCodes</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">data</span><span class="o">,</span> <span class="n">curNodeCode</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 压缩传入字节（将传入字符串转成字节类型）将待压缩字节转换为字节数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">zip</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">huffmanCodes</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 利用 huffmanCodes 将 bytes 转成 赫夫曼编码对应的字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 遍历bytes 数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">b</span> <span class="o">:</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">huffmanCodes</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">b</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 统计返回 byte[] huffmanCodeBytes 长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">len</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 等同于 int len = (stringBuilder.length() + 7) / 8;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">byte</span> <span class="n">countToEight</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">stringBuilder</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&amp;</span> <span class="n">7</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">countToEight</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">len</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;&gt;</span> <span class="n">3</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">len</span> <span class="o">=</span> <span class="o">(</span><span class="n">stringBuilder</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;&gt;</span> <span class="n">3</span><span class="o">)</span> <span class="o">+</span> <span class="n">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 后面补零
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">countToEight</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">8</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;0&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建 存储压缩后的 byte数组，huffmanCodeBytes[len]记录赫夫曼编码最后一个字节的有效位数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">byte</span><span class="o">[]</span> <span class="n">huffmanCodeBytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">len</span> <span class="o">+</span> <span class="n">1</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">huffmanCodeBytes</span><span class="o">[</span><span class="n">len</span><span class="o">]</span> <span class="o">=</span> <span class="n">countToEight</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 因为是每8位对应一个byte,所以步长 +8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">8</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">strByte</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">strByte</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">8</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 将strByte 转成一个byte,放入到 huffmanCodeBytes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">huffmanCodeBytes</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">strByte</span><span class="o">,</span> <span class="n">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">index</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">huffmanCodeBytes</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 将 byte 转换为对应的字符串 解码时要用
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param b 待处理的字节
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return 将字节转换成二进制字符串
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="nf">byteToBitString</span><span class="o">(</span><span class="kt">byte</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果是正数我们需要将高位补零
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">temp</span> <span class="o">|=</span> <span class="n">0x100</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 转换为二进制字符串，正数：高位补 0 即可，然后截取低八位即可；负数直接截取低八位即可
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 负数在计算机内存储的是补码，补码转原码：先 -1 ，再取反
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">String</span> <span class="n">binaryStr</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">temp</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">binaryStr</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">binaryStr</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="n">8</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * huffman 树的结点
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Byte</span> <span class="n">data</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">weight</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Node</span> <span class="n">left</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Node</span> <span class="n">right</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="nf">Node</span><span class="o">(</span><span class="n">Byte</span> <span class="n">data</span><span class="o">,</span> <span class="kt">int</span> <span class="n">weight</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="o">.</span><span class="na">weight</span> <span class="o">=</span> <span class="n">weight</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">Node</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 从小到大排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">weight</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="na">weight</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s">&#34;Node [data = &#34;</span> <span class="o">+</span> <span class="n">data</span> <span class="o">+</span> <span class="s">&#34; weight=&#34;</span> <span class="o">+</span> <span class="n">weight</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HuffmanUnZip</span> <span class="kd">extends</span> <span class="n">HuffmanCode</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">zipOrUnZip</span><span class="o">(</span><span class="n">String</span> <span class="n">zipFile</span><span class="o">,</span> <span class="n">String</span> <span class="n">dstFile</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 定义文件输入流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 定义一个对象输入流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">ObjectInputStream</span> <span class="n">ois</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 定义文件的输出流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 创建文件输入流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="n">zipFile</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 创建一个和 is关联的对象输入流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">ois</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectInputStream</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 读取byte数组 huffmanBytes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">byte</span><span class="o">[]</span> <span class="n">huffmanBytes</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">[])</span> <span class="n">ois</span><span class="o">.</span><span class="na">readObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 读取赫夫曼编码表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">huffmanCodes</span> <span class="o">=</span> <span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;)</span> <span class="n">ois</span><span class="o">.</span><span class="na">readObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 解码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">decode</span><span class="o">(</span><span class="n">huffmanCodes</span><span class="o">,</span> <span class="n">huffmanBytes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 将bytes 数组写入到目标文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">os</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">dstFile</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 写数据到 dstFile 文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">os</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// TODO: handle exception
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">os</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">os</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">ois</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ois</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">is</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">is</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e2</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// TODO: handle exception
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e2</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HuffmanZip</span> <span class="kd">extends</span> <span class="n">HuffmanCode</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">zipOrUnZip</span><span class="o">(</span><span class="n">String</span> <span class="n">srcFile</span><span class="o">,</span> <span class="n">String</span> <span class="n">dstFile</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建输出流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ObjectOutputStream</span> <span class="n">oos</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建文件的输入流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">FileInputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 创建文件的输入流
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="n">srcFile</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 创建一个和源文件大小一样的byte[]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">byte</span><span class="o">[]</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">is</span><span class="o">.</span><span class="na">available</span><span class="o">()];</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 读取文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">is</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 直接对源文件压缩
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">byte</span><span class="o">[]</span> <span class="n">huffmanBytes</span> <span class="o">=</span> <span class="n">encode</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 创建文件的输出流, 存放压缩文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">os</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">dstFile</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 创建一个和文件输出流关联的ObjectOutputStream
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">oos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectOutputStream</span><span class="o">(</span><span class="n">os</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 把 赫夫曼编码后的字节数组写入压缩文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">oos</span><span class="o">.</span><span class="na">writeObject</span><span class="o">(</span><span class="n">huffmanBytes</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 这里我们以对象流的方式写入 赫夫曼编码，是为了以后我们恢复源文件时使用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// 注意一定要把赫夫曼编码 写入压缩文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">oos</span><span class="o">.</span><span class="na">writeObject</span><span class="o">(</span><span class="n">getHuffmanCodesTab</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;使用huffman编码压缩异常！&#34;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">is</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">is</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">oos</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">oos</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">os</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">os</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// TODO: handle exception
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HuffmanFrame</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 当前屏幕的宽
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">WINDOW_WIDTH</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 当前屏幕的高
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">WINDOW_HEIGHT</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">HuffmanFrame</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Dimension</span> <span class="n">screenSize</span> <span class="o">=</span> <span class="n">Toolkit</span><span class="o">.</span><span class="na">getDefaultToolkit</span><span class="o">().</span><span class="na">getScreenSize</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">WINDOW_WIDTH</span> <span class="o">=</span> <span class="n">screenSize</span><span class="o">.</span><span class="na">width</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">WINDOW_HEIGHT</span> <span class="o">=</span> <span class="n">screenSize</span><span class="o">.</span><span class="na">height</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 初始化huffman窗口
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param width  宽
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param height 高
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="kt">int</span> <span class="n">width</span><span class="o">,</span> <span class="kt">int</span> <span class="n">height</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Frame</span> <span class="n">frame</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Frame</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;huffman压缩&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置窗口可见
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">frame</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 禁止调整窗口大小
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">frame</span><span class="o">.</span><span class="na">setResizable</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置窗口大小
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">frame</span><span class="o">.</span><span class="na">setSize</span><span class="o">(</span><span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置窗口出现在屏幕的位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">frame</span><span class="o">.</span><span class="na">setLocation</span><span class="o">((</span><span class="n">WINDOW_WIDTH</span> <span class="o">-</span> <span class="n">width</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="n">1</span><span class="o">,</span> <span class="o">(</span><span class="n">WINDOW_HEIGHT</span> <span class="o">-</span> <span class="n">height</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="n">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">FlowLayout</span> <span class="n">flowLayout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlowLayout</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//设置对齐方式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">flowLayout</span><span class="o">.</span><span class="na">setAlignment</span><span class="o">(</span><span class="n">FlowLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置流式布局
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">frame</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="n">flowLayout</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置按钮
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Button</span> <span class="n">zipBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">&#34;压缩&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Button</span> <span class="n">unZipBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">&#34;解压缩&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">zipBtn</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">frame</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">unZipBtn</span><span class="o">,</span> <span class="n">BorderLayout</span><span class="o">.</span><span class="na">CENTER</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">listenerBtnOfFile</span><span class="o">(</span><span class="n">zipBtn</span><span class="o">,</span> <span class="k">new</span> <span class="n">HuffmanZip</span><span class="o">(),</span><span class="n">frame</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">listenerBtnOfFile</span><span class="o">(</span><span class="n">unZipBtn</span><span class="o">,</span> <span class="k">new</span> <span class="n">HuffmanUnZip</span><span class="o">(),</span><span class="n">frame</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//关闭窗口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">frame</span><span class="o">.</span><span class="na">addWindowListener</span><span class="o">(</span><span class="k">new</span> <span class="n">WindowAdapter</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">windowClosing</span><span class="o">(</span><span class="n">WindowEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 监听点击按钮触发事件，解压缩或压缩
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param btn         按钮对象
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param huffmanCode 压缩或解压缩对象
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">listenerBtnOfFile</span><span class="o">(</span><span class="n">Button</span> <span class="n">btn</span><span class="o">,</span> <span class="n">HuffmanCode</span> <span class="n">huffmanCode</span><span class="o">,</span><span class="n">Frame</span> <span class="n">frame</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">btn</span><span class="o">.</span><span class="na">addActionListener</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">FileDialog</span> <span class="n">openDialog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileDialog</span><span class="o">(</span><span class="n">frame</span><span class="o">,</span> <span class="s">&#34;打开文件&#34;</span><span class="o">,</span> <span class="n">FileDialog</span><span class="o">.</span><span class="na">LOAD</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">openDialog</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">dirName</span> <span class="o">=</span> <span class="n">openDialog</span><span class="o">.</span><span class="na">getDirectory</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">openDialog</span><span class="o">.</span><span class="na">getFile</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">src</span> <span class="o">=</span> <span class="n">dirName</span> <span class="o">+</span> <span class="n">fileName</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">dirName</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">fileName</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 压缩或解压缩后 弹框提示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">JDialog</span> <span class="n">jDialog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JDialog</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">jDialog</span><span class="o">.</span><span class="na">setSize</span><span class="o">(</span><span class="n">200</span><span class="o">,</span> <span class="n">200</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">jDialog</span><span class="o">.</span><span class="na">setLocation</span><span class="o">((</span><span class="n">WINDOW_WIDTH</span> <span class="o">-</span> <span class="n">200</span><span class="o">)</span> <span class="o">/</span> <span class="n">2</span><span class="o">,</span> <span class="o">(</span><span class="n">WINDOW_HEIGHT</span> <span class="o">-</span> <span class="n">200</span><span class="o">)</span> <span class="o">/</span> <span class="n">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">jDialog</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">jDialog</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;提示&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">jDialog</span><span class="o">.</span><span class="na">setLayout</span><span class="o">(</span><span class="k">new</span> <span class="n">FlowLayout</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">JLabel</span> <span class="n">jLabel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s">&#34;.huf&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">dist</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 如果文件包含了后缀则需要解压缩文件 不给原文件添加后缀
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="o">(</span><span class="n">src</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">suffix</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">dist</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">src</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="n">4</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// 如果不包含压缩后缀 &amp;&amp; 传递解压缩类型则无法解压
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">if</span> <span class="o">(</span><span class="n">huffmanCode</span> <span class="k">instanceof</span> <span class="n">HuffmanUnZip</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">jLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;不包含&#34;</span> <span class="o">+</span> <span class="n">suffix</span> <span class="o">+</span> <span class="s">&#34;无法解压！&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="n">jDialog</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">jLabel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">dist</span> <span class="o">=</span> <span class="n">src</span> <span class="o">+</span> <span class="n">suffix</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;原文件：%s \t 目标文件：%s \n&#34;</span><span class="o">,</span> <span class="n">src</span><span class="o">,</span> <span class="n">dist</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">huffmanCode</span><span class="o">.</span><span class="na">zipOrUnZip</span><span class="o">(</span><span class="n">src</span><span class="o">,</span> <span class="n">dist</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">jLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;操作成功！&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">jLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&#34;操作异常！&#34;</span> <span class="o">+</span> <span class="n">exception</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">jDialog</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">jLabel</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HuffmanMainStarter</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">new</span> <span class="n">HuffmanFrame</span><span class="o">().</span><span class="na">init</span><span class="o">(</span><span class="n">200</span><span class="o">,</span><span class="n">70</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div></div>
                    <div class="post_footer">
                        <div class="meta">
                            <div class="info">
                                <span class="field tags">
                                    <i class="ri-stack-line"></i>
                                    
                                    
                                    <a href="https://whiteppure.github.io/iblog/tags/java/">Java</a>
                                    
                                    <a href="https://whiteppure.github.io/iblog/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">小程序</a>
                                    
                                    
                                    
                                    <span id="busuanzi_container_page_pv">
                                      阅读量<span id="busuanzi_value_page_pv"></span>次
                                    </span>
                                    
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                
<div class="doc_comments">
    <div class="comments_block_title">发表评论</div>
    <div id="vcomments"></div>
</div>

<link rel="stylesheet" href="https://whiteppure.github.io/iblog/css/comments.css" />

<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>


<script type="text/javascript">
    new Valine({
        el: '#vcomments',
        appId: 'pRSrjsfbN6L1DUxgfqJWOMYP-gzGzoHsz',
        appKey: 'VPWpnDPGDM8Xhdlh5OvHOpak',
        placeholder: '说点什么吧...',
        visitor: 'true',
        
        emojiCDN: '//i0.hdslb.com/bfs/emote/',
        
        emojiMaps: {
            "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
            "tv_亲亲": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
            "tv_偷笑": "bb690d4107620f1c15cff29509db529a73aee261.png",
            "tv_再见": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
            "tv_冷漠": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
            "tv_发怒": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
            "tv_发财": "34db290afd2963723c6eb3c4560667db7253a21a.png",
            "tv_可爱": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
            "tv_吐血": "09dd16a7aa59b77baa1155d47484409624470c77.png",
            "tv_呆": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
            "tv_呕吐": "9f996894a39e282ccf5e66856af49483f81870f3.png",
            "tv_困": "241ee304e44c0af029adceb294399391e4737ef2.png",
            "tv_坏笑": "1f0b87f731a671079842116e0991c91c2c88645a.png",
            "tv_大佬": "093c1e2c490161aca397afc45573c877cdead616.png",
            "tv_大哭": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
            "tv_委屈": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
            "tv_害羞": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
            "tv_尴尬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
            "tv_微笑": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
            "tv_思考": "90cf159733e558137ed20aa04d09964436f618a1.png",
            "tv_惊吓": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png",
            "tv_打脸": "56ab10b624063e966bfcb76ea5dc4794d87dfd47.png",
            "tv_抓狂": "fe31c08edad661d63762b04e17b8d5ae3c71a757.png",
            "tv_抠鼻": "c666f55e88d471e51bbd9fab9bb308110824a6eb.png",
            "tv_斜眼笑": "911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png",
            "tv_无奈": "ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png",
            "tv_晕": "5443c22b4d07fb1907ccc610c8e6db254f2461b7.png",
            "tv_流汗": "cead1c351ab8d79e9f369605beb90148db0fbed3.png",
            "tv_流泪": "7e71cde7858f0cd50d74b0264aa26db612a8a167.png",
            "tv_流鼻血": "c32d39db2737f89b904ca32700d140a9241b0767.png",
            "tv_点赞": "f85c354995bd99e28fc76c869bfe42ba6438eff4.png",
            "tv_生气": "26702dcafdab5e8225b43ffd23c94ac1ff932654.png",
            "tv_生病": "8b0ec90e6b86771092a498c54f09fc94621c1900.png",
            "tv_疑问": "0793d949b18d7be716078349c202c15ff166f314.png",
            "tv_白眼": "c1d59f439e379ee50eef488bcb5e5378e5044ea4.png",
            "tv_皱眉": "72ccad6679fea0d14cce648b4d818e09b8ffea2d.png",
            "tv_目瞪口呆": "0b8cb81a68de5d5365212c99375e7ace3e7891b7.png",
            "tv_睡着": "8b196675b53af58264f383c50ad0945048290b33.png",
            "tv_笑哭": "1abc628f6d4f4caf9d0e7800878f4697abbc8273.png",
            "tv_腼腆": "89712c0d4af73e67f89e35cbc518420380a7f6f4.png",
            "tv_色": "61822c7e9aae5da76475e7892534545336b23a6f.png",
            "tv_调侃": "4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png",
            "tv_调皮": "b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png",
            "tv_鄙视": "6e72339f346a692a495b123174b49e4e8e781303.png",
            "tv_闭嘴": "c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png",
            "tv_难过": "87f46748d3f142ebc6586ff58860d0e2fc8263ba.png",
            "tv_馋": "fc7e829b845c43c623c8b490ee3602b7f0e76a31.png",
            "tv_鬼脸": "0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png",
            "tv_黑人问号": "45821a01f51bc867da9edbaa2e070410819a95b2.png",
            "tv_鼓掌": "1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png"
        }
    })
</script>

                
            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="powered_by">
        <a href="https://varkai.com">Designed by VarKai,</a>
        <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
    </div>

    <div class="footer_slogan">
        <span>whitepure@2022</span>
    </div>
</footer>
    <script src="https://whiteppure.github.io/iblog/js/jquery-3.5.1.min.js"></script>
<link href="https://whiteppure.github.io/iblog/css/fancybox.min.css" rel="stylesheet">
<script src="https://whiteppure.github.io/iblog/js/fancybox.min.js"></script>
<script src="https://whiteppure.github.io/iblog/js/darkmode-js.js"></script>
<script src="https://whiteppure.github.io/iblog/js/zozo.js"></script>


<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>




<script src="https://cdn.bootcdn.net/ajax/libs/jspdf/1.0.106/jspdf.debug.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


























































<script>
    var options = {
        right: '32px', 
        bottom: 'unset', 
        
        time: '0.8s', 
        mixColor: '#f7f7f7', 
        backgroundColor: '#f7f7f7', 
        buttonColorDark: '#212121', 
        buttonColorLight: '#f7f7f7', 
        saveInCookies: false, 
        autoMatchOsTheme: true 
    }
    const darkmode = new Darkmode(options);
    darkmode.showWidget();
</script>
</body>

</html>